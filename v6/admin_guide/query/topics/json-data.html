<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      使用JSON数据 |
    Greenplum Database Docs
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='/images/favicon.ico' rel='shortcut icon'>

  <script src="/javascripts/all.js"></script>
  
</head>

<body class="x6-0 x6-0_admin_guide x6-0_admin_guide_query x6-0_admin_guide_query_topics x6-0_admin_guide_query_topics_json-data has-subnav">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">
      document.domain = "greenplum.org";
    </script>

     
  <header class="header header-layout">
    <h1 class="logo">
      <a href="/">Greenplum Database Documentation</a>
    </h1>
    
    <div class="header-links js-bar-links">
      <div class="btn-menu" data-behavior="MenuMobile"></div>
      <div class="header-item"><a href="https://greenplum.org">Back to Greenplum Database</a></div>
      <div class="header-item">
        <a href="https://github.com/greenplum-db/gpdb/wiki">Wiki</a>
      </div>
      
    </div>
  </header>


    <div class="container">

      <!--googleoff: index-->
      <div id="sub-nav" class="nav-container js-sidenav" role="navigation" >
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/../../v6/homenav.html">Greenplum数据库® 6.0文档</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/admin_guide.html">管理员指南</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/intro/partI.html">Greenplum数据库概念</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/intro/arch_overview.html">关于Greenplum的架构</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/intro/about_utilities.html">关于管理和监控工具</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/intro/about_mvcc.html">关于Greenplum数据库中的并发控制</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/intro/mvcc_example.html">管理事务ID的例子</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/v6/admin_guide/intro/about_loading.html">关于并行数据装载</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/intro/about_ha.html">关于Greenplum数据库中的冗余和故障切换</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/intro/about_statistics.html">关于Greenplum数据库中的数据库统计信息</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/managing/partII.html">管理一个Greenplum系统</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/managing/versioning.html">关于Greenplum数据库发布版本号</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/startstop.html">启动和停止Greenplum数据库</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/access_db/topics/g-accessing-the-database.html">访问数据库</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/access_db/topics/g-establishing-a-database-session.html">建立一个数据库会话</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/access_db/topics/g-supported-client-applications.html">支持的客户端应用</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/access_db/topics/g-greenplum-database-client-applications.html">Greenplum数据库客户端应用</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/access_db/topics/g-connecting-with-psql.html">用psql连接</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/access_db/topics/pgbouncer.html">使用PgBouncer连接池</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/access_db/topics/g-database-application-interfaces.html">数据库应用接口</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/access_db/topics/g-troubleshooting-connection-problems.html">连接问题的发现及解决</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/topics/g-configuring-the-greenplum-system.html">配置Greenplum数据库系统</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/topics/g-about-greenplum-master-and-local-parameters.html">关于Greenplum数据库的Master参数和本地参数</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/topics/g-setting-configuration-parameters.html">设置配置参数</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/topics/g-setting-a-local-configuration-parameter.html">设置本地配置参数</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/topics/g-setting-a-master-configuration-parameter.html">设置Master配置参数</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/topics/g-setting-parameters-at-the-system-level.html">设置系统级别参数</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/topics/g-setting-parameters-at-the-database-level.html">设置数据库级别参数</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/topics/g-setting-parameters-at-the-role-level.html">设置角色级别参数</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/topics/g-setting-parameters-in-a-session.html">设置会话级别参数</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/v6/admin_guide/topics/g-viewing-server-configuration-parameter-settings.html">查看服务器配置参数设置</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/topics/g-configuration-parameter-categories.html">配置参数种类</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/compression.html">启用压缩</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/highavail/topics/g-enabling-high-availability-features.html">启用高可用和数据持久化特征</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/highavail/topics/g-overview-of-high-availability-in-greenplum-database.html">Greenplum数据库高可用性概述</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/highavail/topics/g-overview-of-segment-mirroring.html">Segment镜像概述</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/highavail/topics/g-overview-of-master-mirroring.html">Master镜像概述</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/highavail/topics/g-enabling-mirroring-in-greenplum-database.html">在Greenplum数据库中启用镜像</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/highavail/topics/g-enabling-segment-mirroring.html">启用Segment镜像</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/highavail/topics/g-enabling-master-mirroring.html">启用Master镜像</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/highavail/topics/g-detecting-a-failed-segment.html">检测故障的Segment</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/highavail/topics/g-checking-for-failed-segments.html">检测故障Segment</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/highavail/topics/g-checking-the-log-files.html">检查日志文件</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/highavail/topics/g-recovering-a-failed-segment.html">恢复故障Segment</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/highavail/topics/g-recovering-from-segment-failures.html">从Segment故障中恢复</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/highavail/topics/g-when-a-segment-host-is-not-recoverable.html">当一台Segment主机不可恢复时</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/highavail/topics/g-recovering-a-failed-master.html">恢复故障的Master</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/highavail/topics/g-restoring-master-mirroring-after-a-recovery.html">在恢复后还原Master镜像</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/managing/backup-main.html">备份和恢复数据库</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/managing/backup-overview.html">备份和恢复概述</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/managing/backup-gpbackup.html">使用gpbackup和gprestore并行备份</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/managing/backup-gpbackup.html#topic_vh5_1hd_tbb">需求和限制</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/backup-gpbackup.html#topic_x3s_lqj_tbb">备份或还原中包含的对象</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/backup-gpbackup.html#topic_qgj_b3d_tbb">执行基本备份和还原操作</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/backup-gpbackup.html#topic_et4_b5d_tbb">过滤备份或恢复的内容</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/backup-gpbackup.html#topic_qwd_d5d_tbb">配置邮件通知</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/backup-gpbackup.html#topic_xnj_b4c_tbb">理解备份文件</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/managing/backup-gpbackup-incremental.html">使用gpbackup和gprestore创建增量备份</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/managing/backup-gpbackup-incremental.html#topic_kvf_mkr_t2b">关于增量备份集</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/backup-gpbackup-incremental.html#topic_btr_xfr_t2b">使用增量备份</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/managing/backup-boostfs.html">将gpbackup和gprestore与BoostFS一起使用</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/managing/backup-boostfs.html#topic_zp4_mvv_bdb">安装BoostFS</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/backup-boostfs.html#topic_t4z_tvv_bdb">使用BoostFS备份和恢复</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/managing/backup-plugins.html">使用gpbackup存储插件</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/managing/backup-s3-plugin.html">使用带有gpbackup和gprestore的S3存储插件</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/managing/backup-plugin-api.html">备份&#x2F;恢复存储插件API（Beta版）</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/managing/plugin_api/backup_data.html">backup_data</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/plugin_api/backup_file.html">backup_file</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/plugin_api/cleanup_plugin_for_backup.html">cleanup_plugin_for_backup</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/plugin_api/cleanup_plugin_for_restore.html">cleanup_plugin_for_restore</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/plugin_api/plugin_api_version.html">plugin_api_version</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/plugin_api/restore_data.html">restore_data</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/plugin_api/restore_file.html">restore_file</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/plugin_api/setup_plugin_for_backup.html">setup_plugin_for_backup</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/plugin_api/setup_plugin_for_restore.html">setup_plugin_for_restore</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/expand/expand-main.html">扩容Greenplum系统</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/expand/expand-overview.html">系统扩容概述</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/expand/expand-planning.html">规划Greenplum系统扩容</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/expand/expand-nodes.html">准备并增加节点</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/expand/expand-initialize.html">初始化新节点</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/expand/expand-redistribute.html">重分布表</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/expand/expand-rm-schema.html">移除扩容Schema</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/monitor.html">监控Greenplum系统</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/managing/maintain.html">日常系统维护任务</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/monitoring/monitoring.html">Recommended Monitoring and Maintenance Tasks</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/partIII.html">管理Greenplum数据库访问</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/client_auth.html">配置客户端认证</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/ldap.html">使用带TLS&#x2F;SSL的LDAP认证</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/kerberos.html">使用Kerberos认证</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/kerberos-lin-client.html">为Linux客户端进行Kerberos配置</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/kerberos-win-client.html">为Windows客户端进行Kerberos配置</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/v6/admin_guide/roles_privs.html">管理角色与权限</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/ddl/ddl.html">定义数据库对象</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/ddl/ddl-database.html">创建和管理数据库</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/ddl/ddl-tablespace.html">创建和管理表空间</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/ddl/ddl-schema.html">创建和管理SCHEMA</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/ddl/ddl-table.html">创建和管理表</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/ddl/ddl-storage.html">选择表存储模型</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/ddl/ddl-partition.html">对大型表分区</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/ddl/ddl-sequence.html">创建和使用序列</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/ddl/ddl-index.html">在Greenplum数据库中使用索引</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/ddl/ddl-view.html">创建和管理视图</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/v6/admin_guide/distribution.html">分布与倾斜</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/dml.html">插入, 更新, 和删除数据 </a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/query/topics/query.html">查询数据</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/parallel-proc.html">关于Greenplum的查询处理</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/query/topics/query-piv-optimizer.html">关于GPORCA</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/query-piv-opt-overview.html">GPORCA概述</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/query-piv-opt-enable.html">启用和禁用GPORCA</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/query-piv-opt-root-partition.html">收集根分区统计信息</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/query-piv-opt-notes.html">使用GPORCA时的考虑</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/query-piv-opt-features.html">GPORCA特性和增强</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/query-piv-opt-changed.html">GPORCA改变的行为</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/query-piv-opt-limitations.html">GPORCA的限制</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/query-piv-opt-fallback.html">判断被使用的查询优化器</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/query-piv-uniform-part-tbl.html">关于统一多级分区表</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/defining-queries.html">定义查询</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/CTE-query.html">WITH查询（公用表表达式）</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/functions-operators.html">使用函数和操作符</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/json-data.html">使用JSON数据</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/xml-data.html">使用XML数据</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/textsearch/full-text-search.html">使用全文搜索</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/textsearch/intro.html">关于全文搜索</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/textsearch/tables-indexes.html">在数据库表中搜索文本</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/textsearch/controlling.html">控制文本搜索</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/textsearch/features.html">文本搜索附加功能</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/textsearch/parsers.html">文本搜索解析器</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/textsearch/dictionaries.html">文本搜索词典</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/textsearch/configuration.html">文本搜索配置示例</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/textsearch/testing.html">测试和调试文本搜索</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/textsearch/gist-gin.html">文本搜索的GiST和GIN索引</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/textsearch/psql-support.html">psql支持</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/textsearch/limitations.html">限制</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/query-performance.html">查询性能</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/spill-files.html">管理查询生成的溢出文件</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/query/topics/query-profiling.html">查询分析</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/external/g-working-with-file-based-ext-tables.html">使用外部数据</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/external/g-external-tables.html">定义外部表</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-file-protocol.html">file:&#x2F;&#x2F;协议</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-gpfdist-protocol.html">gpfdist:&#x2F;&#x2F;协议</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-gpfdists-protocol.html">gpfdists:&#x2F;&#x2F; 协议</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-pxf-protocol.html">pxf:&#x2F;&#x2F; 协议</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-s3-protocol.html">s3:&#x2F;&#x2F; 协议</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-accessing-ext-files-custom-protocol.html">使用自定义协议</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-handling-errors-ext-table-data.html">处理外部表数据中的错误</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-creating-and-using-web-external-tables.html">创建和使用外部Web表</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/external/g-creating-external-tables---examples.html">Examples for Creating External Tables</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-example-1-single-gpfdist-instance-on-single-nic-machine.html">Example 1—Single gpfdist instance on single-NIC machine</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-example-2-multiple-gpfdist-instances.html">Example 2—Multiple gpfdist instances </a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-example-3-multiple-gpfdists-instances.html">Example 3—Multiple gpfdists instances </a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-example-4-single-gpfdist-instance-with-error-logging.html">Example 4—Single gpfdist instance with error logging</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-example-5-text-format-on-a-hadoop-distributed-file-server.html">Example 5—TEXT Format on a Hadoop Distributed File Server</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-example-6-multiple-files-in-csv-format-with-header-rows.html">Example 6—Multiple files in CSV format with header rows</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-example-7-readable-web-external-table-with-script.html">Example 7—Readable External Web Table with Script</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-example-8-writable-external-table-with-gpfdist.html">Example 8—Writable External Table with gpfdist</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-example-9-writable-external-web-table-with-script.html">Example 9—Writable External Web Table with Script</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-example-10-readable-and-writable-external-tables-with-xml-transformations.html">Example 10—Readable and Writable External Tables with XML Transformations</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/pxf-overview.html">使用PXF访问外部数据</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/external/g-foreign.html">使用外部表访问外部数据</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-devel-fdw.html">写一个外部数据的包装器</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/g-using-the-greenplum-parallel-file-server--gpfdist-.html">使用Greenplum的并行文件服务器（gpfdist）</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/load/topics/g-loading-and-unloading-data.html">装载和卸载数据</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-loading-data-using-an-external-table.html">使用外部表装载数据</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/load/topics/g-loading-and-writing-non-hdfs-custom-data.html">装载和写入非HDFS自定义数据</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/load/topics/g-using-a-custom-format.html">使用一种自定义格式</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-importing-and-exporting-fixed-width-data.html">导入和导出固定宽度的数据</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-examples-read-fixed-width-data.html">例子：读取宽度固定的数据</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-using-a-custom-protocol.html">使用一种自定协议</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/load/topics/g-handling-load-errors.html">处理装载错误</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-define-an-external-table-with-single-row-error-isolation.html">定义一个带有单行错误隔离的外部表</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-create-an-error-table-and-declare-a-reject-limit.html">捕捉行格式化错误并且声明拒绝极限 </a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-viewing-bad-rows-in-the-error-table-or-error-log.html">在错误日志中查看不正确的行</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-moving-data-between-tables.html">在表之间移动数据</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-loading-data-with-gpload.html">用gpload装载数据</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/external/pxf-overview.html">使用PXF访问外部数据</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/transforming-xml-data.html">使用gpfdist和gpload转换外部数据</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-loading-data-with-copy.html">用COPY装载数据</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-running-copy-in-single-row-error-isolation-mode.html">在单行错误隔离模式中运行COPY</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-optimizing-data-load-and-query-performance.html">优化数据装载和查询性能</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/load/topics/g-unloading-data-from-greenplum-database.html">从Greenplum数据库卸载数据</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/load/topics/g-defining-a-file-based-writable-external-table.html">定义基于文件的可写外部表</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-example-1-greenplum-file-server-gpfdist.html">例 1—Greenplum文件服务器（gpfdist）</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-example-2-hadoop-file-server.html">例 2—Hadoop文件系统(pxf)</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/load/topics/g-defining-a-command-based-writable-external-web-table.html">定义基于命令的可写外部Web表</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-disabling-execute-for-web-or-writable-external-tables.html">为Web或者可写外部表禁用EXECUTE</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-unloading-data-using-a-writable-external-table.html">使用可写外部表卸载数据</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-unloading-data-using-copy.html">使用COPY卸载数据</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/load/topics/g-formatting-data-files.html">格式化数据文件</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-formatting-rows.html">格式化行</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-formatting-columns.html">格式化列</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-representing-null-values.html">表示NULL值</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/load/topics/g-escaping.html">转义</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-escaping-in-text-formatted-files.html">在文本格式的文件中转义</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-escaping-in-csv-formatted-files.html">在CSV格式的文件中转义</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-character-encoding.html">字符编码</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/load/topics/g-example-custom-data-access-protocol.html">自定义数据访问协议实例 </a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/load/topics/g-installing-the-external-table-protocol.html">安装外部表协议</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/load/topics/g-gpextprotocal.c.html">gpextprotocal.c</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/partV.html">性能管理</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/perf_intro.html">管理性能</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/perf_issues.html">性能问题的常见原因</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/wlmgmt_intro.html">Greenplum数据库内存总览</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/admin_guide/wlmgmt.html">管理资源</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/admin_guide/workload_mgmt_resgroups.html">用资源组进行工作负载管理</a>
        

      </li>
    
      <li class="">
        <a href="/v6/admin_guide/workload_mgmt.html">使用资源队列</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/v6/admin_guide/perf_troubleshoot.html">检修性能问题</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
  </ul>


  </div>
</div>

      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        
          <h1 class="title-container" style="display: none;">
    使用JSON数据
  </h1>

          <div id="js-quick-links" >
            
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        

  <h1 class="title topictitle1">使用JSON数据</h1>

  
  <div class="body">
<p class="shortdesc">Greenplum数据库支持<samp class="ph codeph">json</samp>和<samp class="ph codeph">jsonb</samp>数据类型来存储JSON (JavaScript Object Notation)数据。</p>

    <p class="p">Greenplum数据库按照文档<a class="xref" href="https://tools.ietf.org/html/rfc7159" target="_blank">RFC 7159</a>
      支持JSON,并且根据JSON规则强制数据有效性。也有一些用于<samp class="ph codeph">json</samp> and <samp class="ph codeph">jsonb</samp>数据类型的JSON相关的函数和操作符。参见<a class="xref" href="#topic_gn4_x3w_mq">JSON函数和操作符</a>. </p>

    <div class="p">这一节包含下列主题：<ul class="ul" id="topic1__ul_sjd_hsr_fz">
        <li class="li"><a class="xref" href="#topic_upc_tcs_fz">关于JSON数据</a></li>

        <li class="li"><a class="xref" href="#topic_isn_ltw_mq">JSON输入和输出语法</a></li>

        <li class="li"><a class="xref" href="#topic_eyt_3tw_mq">设计JSON文档</a></li>

        <li class="li"><a class="xref" href="#topic_isx_2tw_mq">jsonb容器与存在</a></li>

        <li class="li"><a class="xref" href="#topic_aqt_1tw_mq">jsonb索引</a></li>

        <li class="li"><a class="xref" href="#topic_gn4_x3w_mq">JSON函数和操作符</a></li>

      </ul>
</div>

  </div>

  <div class="related-links">
<div class="familylinks">
<div class="parentlink">
<strong>Parent topic:</strong> <a class="link" href="../../query/topics/query.html" title="本主题提供在Greenplum数据库中使用SQL的信息。">查询数据</a>
</div>
</div>
</div>
<div class="topic nested1" id="topic_upc_tcs_fz">
    <h2 class="title topictitle2">关于JSON数据</h2>

    <div class="body">
      <div class="p">Greenplum数据库支持两种JSON数据类型: <samp class="ph codeph">json</samp> and
          <samp class="ph codeph">jsonb</samp>. 他们输入值基本一致，主要区别之一是效率。 <ul class="ul" id="topic_upc_tcs_fz__ul_qv2_zrw_mq">
          <li class="li">The <samp class="ph codeph">json</samp>数据类型存储输入副本. 这要求JSON处理函数每次执行时处理<samp class="ph codeph">json</samp> 数据。<samp class="ph codeph">json</samp>数据类型不会修改输入文本。<ul class="ul" id="topic_upc_tcs_fz__ul_yrn_njf_pfb">
              <li class="li">记号之间没有语义意义的空格被保留，JSON对象内的键的顺序也被保留。</li>

              <li class="li">即便JSON对象含有重复键，所有的键/值对也会被保留。对于重复键，JSON处理函数把其中的最后一个值当作有效值。</li>

            </ul>
</li>

          <li class="li"> <samp class="ph codeph">jsonb</samp>数据类型存储输入文本的二进制格式。输入数据的转换开销使jsonb稍慢于
              <samp class="ph codeph">json</samp>数据类型. 但是, json处理函数明显更快，因为解析<samp class="ph codeph">jsonb</samp>数据不是必须的。
              <samp class="ph codeph">jsonb</samp>数据类型修改输入文本。<ul class="ul" id="topic_upc_tcs_fz__ul_bzp_hkf_pfb">
              <li class="li">空格不保留</li>

              <li class="li">对象内的键的顺序不保留</li>

              <li class="li">重复键对象不保留，如果输入包含重复键，仅保留最后一个值。</li>

            </ul>
<p class="p"><samp class="ph codeph">jsonb</samp>数据类型支持索引。参考 <a class="xref" href="#topic_aqt_1tw_mq">jsonb索引</a>.</p>
</li>

        </ul>
</div>

      <p class="p">一般来说，JSON数据应该存储为<samp class="ph codeph">jsonb</samp>数据类型，除非特殊需要，例如关于对象键顺序的遗留假设。</p>

      <div class="section">
<h3 class="title sectiontitle">关于JSON数据中的Unicode字符</h3>
        
        <p class="p">The <a class="xref" href="http://rfc7159.net/rfc7159" target="_blank">RFC
            7159</a>文档允许JSON字符串包含表示为\uXXXX的<samp class="ph codeph">\u<var class="keyword varname">XXXX</var></samp>Unicode转义序列。不过, Greenplum对每一个数据库只允许一种字符集编码。
          除非数据库编码为UTF8，<samp class="ph codeph">json</samp>类型不可能严格地符合JSON说明。尝试包括数据库编码中无法表示的字符将会失败。允许可在数据库编码中表示但不在UTF8中的字符。</p>

        <div class="p">
          <ul class="ul" id="topic_upc_tcs_fz__ul_ejw_ppf_pfb">
            <li class="li">
<samp class="ph codeph">json</samp>数据类型的greenplum数据库输入函数允许unicode转义，而无论是什么数据库编码，只检查unicode转义的语法正确性（a <samp class="ph codeph">\u</samp>后跟四个十六进制数字）。
              </li>

            <li class="li">
<samp class="ph codeph">jsonb</samp>数据类型的greenplum数据库输入函数更严格。它不允许非ASCII字符（<samp class="ph codeph">U+007F</samp>以上的字符）使用Unicode转义，除非数据库编码是UTF8。它还拒绝<samp class="ph codeph">\u0000</samp>，它不能在greenplum数据库<samp class="ph codeph">text</samp>类型中表示，并且它要求使用unicode代理项对指定unicode基本多语言平面之外的字符是正确的。有效的Unicode转义符（除了<samp class="ph codeph">\u0000</samp>）转换为等效的ASCII或UTF8字符进行存储；这包括将代理项对折叠为单个字符。
              </li>

          </ul>

        </div>

        <div class="note note">
<span class="notetitle">Note:</span>  <a class="xref" href="#topic_gn4_x3w_mq">JSON函数和运算符</a>中描述的许多JSON处理函数将Unicode转义转换为常规字符。函数对数据库编码中无法表示的字符抛出错误。如果可能的话，应该避免将JSON中的Unicode转义与非UTF8数据库编码混合在一起。</div>

      </div>

      <div class="section">
<h3 class="title sectiontitle">将JSON数据类型映射到Greenplum数据类型</h3>
        
        <p class="p">When converting JSON text input into <samp class="ph codeph">jsonb</samp> data, the primitive data
          types described by RFC 7159 are effectively mapped onto native Greenplum Database data
          types, as shown in the following table.</p>

        
<div class="tablenoborder">
<table cellpadding="4" cellspacing="0" summary="" id="topic_upc_tcs_fz__table_spm_m3w_mq" class="table" frame="border" border="1" rules="all">
<caption><span class="tablecap">Table 1. 将JSON数据类型映射到Greenplum数据类型</span></caption>
            
            
            
            <thead class="thead" align="left">
              <tr class="row">
                <th class="entry" valign="top" id="d87184e250">JSON原始数据类型</th>

                <th class="entry" valign="top" id="d87184e253">Greenplum数据库数据类型</th>

                <th class="entry" valign="top" id="d87184e256">注意</th>

              </tr>

            </thead>

            <tbody class="tbody">
              <tr class="row">
                <td class="entry" valign="top" headers="d87184e250 ">
<samp class="ph codeph">string</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e253 ">
<samp class="ph codeph">text</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e256 ">不允许使用<samp class="ph codeph">\u0000</samp>。只有当数据库编码为utf8时，才允许使用非ASCII Unicode转义。</td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" headers="d87184e250 ">
<samp class="ph codeph">number</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e253 ">
<samp class="ph codeph">numeric</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e256 ">不允许使用<samp class="ph codeph">NaN</samp>和<samp class="ph codeph">infinity</samp>值
         </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" headers="d87184e250 ">
<samp class="ph codeph">boolean</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e253 ">
<samp class="ph codeph">boolean</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e256 ">只接受小写的正误拼写</td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" headers="d87184e250 ">
<samp class="ph codeph">null</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e253 ">(none)</td>

                <td class="entry" valign="top" headers="d87184e256 ">The JSON <samp class="ph codeph">null</samp> 原始类型不同于SQL <samp class="ph codeph">NULL</samp>。</td>

              </tr>
            </tbody>

          </table>
</div>

        <p class="p">对于有效的<samp class="ph codeph">jsonb</samp> 数据的构成有一些次要的约束，这些约束既不适用于<samp class="ph codeph">json</samp> 数据类型，也不适用于抽象的JSON，对应于基础数据类型所能表示的限制。值得注意的是，当将数据转换为<samp class="ph codeph">jsonb</samp>数据类型时，超出Greenplum数据库<samp class="ph codeph">numeric</samp>数据类型范围的数字将被拒绝，而<samp class="ph codeph">json</samp>数据类型不会拒绝这些数字。
        </p>

        <p class="p">RFC 7159允许这种实施定义的限制。然而，在实践中，这些问题可能会出现在其他实现中，因为通常将JSON原始类型 <samp class="ph codeph">number</samp>表示为IEEE 754双精度浮点（RFC7159明确预测并允许）。
          </p>

        <p class="p">当使用JSON作为与其他系统的交换格式时，请注意与Greenplum数据库最初存储的数据相比，数字精度可能会降低。</p>

        <p class="p">另外，正如上表中所指出的，对于JSON原语类型的输入格式，存在一些小的限制，这些限制不适用于相应的Greenplum数据库数据类型。 </p>

      </div>

    </div>

  </div>

  <div class="topic nested1" id="topic_isn_ltw_mq">
    <h2 class="title topictitle2">JSON输入和输出语法</h2>

    <div class="body">
      <p class="p"> <samp class="ph codeph">json</samp>数据类型的输入和输出语法如RFC 7159中所述。</p>

      <p class="p">下列都是合法的<samp class="ph codeph">json</samp>表达式：</p>

      <pre class="pre codeblock">-- 简单标量/原始值
-- 原始值值可以是数字、带引号的字符串、true、false或者null SELECT '5'::json;

-- 零个或者更多个元素的数组（元素类型可以不同）
          SELECT '[1, 2, "foo", null]'::json;

-- 含有键/值对的对象
-- 注意对象的键必须总是带引号的字符串
SELECT '{"bar": "baz", "balance": 7.77, "active": false}'::json;

-- 数组和对象可以任意嵌套
SELECT '{"foo": [true, "bar"], "tags": {"a": 1, "b": null}}'::json;</pre>

      <p class="p">如前所述，当输入JSON值，然后在不进行任何附加处理的情况下打印时，<samp class="ph codeph">json</samp>数据类型输出的文本与输入的文本相同，而<samp class="ph codeph">jsonb</samp>数据类型不保留语义上不重要的细节，如空白。例如，请注意这里的区别：</p>

      <pre class="pre codeblock">SELECT '{"bar": "baz", "balance": 7.77, "active":false}'::json;
                      json                       
-------------------------------------------------
 {"bar": "baz", "balance": 7.77, "active":false}
(1 row)

SELECT '{"bar": "baz", "balance": 7.77, "active":false}'::jsonb;
                      jsonb                       
--------------------------------------------------
 {"bar": "baz", "active": false, "balance": 7.77}
(1 row)</pre>

      <p class="p">值得注意的一个语义上不重要的细节是，对于<samp class="ph codeph">jsonb</samp>数据类型，将根据基础数字类型的行为打印数字。在实践中，这意味着使用e符号输入的数字将不使用e符号打印，例如：
         </p>

      <pre class="pre codeblock">SELECT '{"reading": 1.230e-5}'::json, '{"reading": 1.230e-5}'::jsonb;
         json          |          jsonb          
-----------------------+-------------------------
 {"reading": 1.230e-5} | {"reading": 0.00001230}
(1 row)</pre>

      <p class="p">然而, <samp class="ph codeph">jsonb</samp>数据类型保留了尾随的小数零，如前一个示例中所示，即使这些小数零在语义上对于诸如相等性检查之类的是无关紧要的。</p>

    </div>

  </div>

  <div class="topic nested1" id="topic_eyt_3tw_mq">
    <h2 class="title topictitle2">设计JSON文档</h2>

    <div class="body">
      <p class="p">将数据表示为JSON比传统关系数据模型要更灵活，在需求变化的环境中表现得尤其明显。在同一个应用中很可能两种方法会共存并且成为彼此的互补。不过，即便是对于要求最大灵活性的应用中，我们仍然推荐JSON有些许固定的结构。这种结构是非强制的（尽管可能会强制一些业务规则），但是如果有可预测的结构会让编写有效汇总表中一组“文档”（数据）的查询更容易。</p>

      <p class="p">在表中存储时，JSON数据服从和其他任何数据类型一样的并发控制考虑。尽管存储大型文档格式可行的，但要记住任何更新都要求整个行上的一个行级锁。为了降低更新事务之间的锁竞争，请考虑限制JSON文档为一个可管理的尺寸。理想上，每个JSON文档应该表示业务规则规定的一个原子数据，并且不能进一步地被分解为更小的可以独立修改的数据。
    </p>

    </div>

  </div>

  <div class="topic nested1" id="topic_isx_2tw_mq">
    <h2 class="title topictitle2">jsonb容器与存在</h2>

    <div class="body">
      <p class="p">测试<em class="ph i">容器</em>是<samp class="ph codeph">jsonb</samp>的一项重要功能。 <samp class="ph codeph">json</samp>类型没有并行的设施集。容器测试一个<samp class="ph codeph">jsonb</samp> 文档中是否包含了另一个<samp class="ph codeph">jsonb</samp> 文档。这些例子返回true，除非另有标注：
    </p>

      <pre class="pre codeblock">--简单标量/原始数值仅包含相同的值：
SELECT '"foo"'::jsonb @&gt; '"foo"'::jsonb;

-- 右边的数组包含在左边的数组中：
SELECT '[1, 2, 3]'::jsonb @&gt; '[1, 3]'::jsonb;

--数组元素的顺序并不重要，因此这也是正确的：
SELECT '[1, 2, 3]'::jsonb @&gt; '[3, 1]'::jsonb;

-- 重复的数组元素也不重要：
SELECT '[1, 2, 3]'::jsonb @&gt; '[1, 2, 2]'::jsonb;

-- 右侧只有一对的对象包含在左侧的对象中:
SELECT '{"product": "Greenplum", "version": "6.0.0", "jsonb":true}'::jsonb @&gt; '{"version":"6.0.0"}'::jsonb;

--右侧的数组被认为不包含在左侧的数组中，即使其中嵌套了类似的数组：
SELECT '[1, 2, [1, 3]]'::jsonb @&gt; '[1, 3]'::jsonb;  -- yields false

--但是，通过一层嵌套，它包含：
SELECT '[1, 2, [1, 3]]'::jsonb @&gt; '[[1, 3]]'::jsonb;

--同样，此处未报告遏制：
SELECT '{"foo": {"bar": "baz", "zig": "zag"}}'::jsonb @&gt; '{"bar": "baz"}'::jsonb; -- yields false

-- 但是，通过一层嵌套，它包含：
SELECT '{"foo": {"bar": "baz", "zig": "zag"}}'::jsonb @&gt; '{"foo": {"bar": "baz"}}'::jsonb;</pre>

      <p class="p">一般原则是，所包含的对象必须在结构和数据内容方面与包含的对象匹配，可能是在从包含的对象中丢弃一些不匹配的数组元素或对象键/值对之后。
          对于容器，在进行容器匹配时，数组元素的顺序并不重要，重复的数组元素只被有效地考虑一次。
         </p>

      <p class="p">作为结构必须匹配的一般原则的例外，数组可以包含原始值：</p>

      <pre class="pre codeblock">-- 此数组包含原始字符串值：:
SELECT '["foo", "bar"]'::jsonb @&gt; '"bar"'::jsonb;

-- 这个异常不是相互的——这里报告了非包容：:
SELECT '"bar"'::jsonb @&gt; '["bar"]'::jsonb;  -- yields false</pre>

      <p class="p"><samp class="ph codeph">jsonb</samp> 还有一个<em class="ph i">existence</em>操作符，它是容器主题的变体：它测试字符串（作为文本值给出）是否作为对象键或数组元素出现在<samp class="ph codeph">jsonb</samp> 值的顶层。这些示例返回true，，除非另有标注：
       </p>

      <pre class="pre codeblock">-- 字符串作为数组元素存在：
SELECT '["foo", "bar", "baz"]'::jsonb ? 'bar';

-- 字符串作为对象键存在：
SELECT '{"foo": "bar"}'::jsonb ? 'foo';

-- 不考虑对象值：
SELECT '{"foo": "bar"}'::jsonb ? 'bar';  -- yields false

-- 与容器一样，存在必须在顶层匹配：
SELECT '{"foo": {"bar": "baz"}}'::jsonb ? 'bar'; -- yields false

-- 如果字符串与原始JSON字符串匹配，则认为该字符串存在：
SELECT '"foo"'::jsonb ? 'foo';</pre>

      <p class="p">当涉及到许多键或元素时，JSON对象比数组更适合测试包含性或存在性，因为与数组不同，JSON对象在内部针对搜索进行了优化，不需要进行线性搜索。</p>

      <p class="p">各种容器和存在操作符以及所有其他JSON操作符和函数都记录在JSON函数和操作符<a class="xref" href="#topic_gn4_x3w_mq">JSON函数和操作符</a>中。</p>

      <p class="p">因为JSON容器是嵌套的，所以适当的查询可以跳过子对象的显式选择。例如，假设我们有一个包含顶级对象的doc列，其中大多数对象包含子对象数组的标记字段。此查询查找包含<samp class="ph codeph">"term":"paris"</samp>和<samp class="ph codeph">"term":"food"</samp>的子对象出现的条目，同时忽略标记数组之外的任何此类键：
        </p>

      <pre class="pre codeblock">SELECT doc-&gt;'site_name' FROM websites
  WHERE doc @&gt; '{"tags":[{"term":"paris"}, {"term":"food"}]}';</pre>

      <p class="p">使用这个谓词的查询可以完成相同的事情。</p>

      <pre class="pre codeblock">SELECT doc-&gt;'site_name' FROM websites
  WHERE doc-&gt;'tags' @&gt; '[{"term":"paris"}, {"term":"food"}]';</pre>

      <p class="p">然而，第二种方法的灵活性较低，而且效率通常也较低。</p>

      <p class="p">另一方面，json存在操作符不是嵌套的：它只在json值的顶层查找指定的键或数组元素。</p>

    </div>

  </div>

  <div class="topic nested1" id="topic_aqt_1tw_mq">
    <h2 class="title topictitle2">jsonb索引</h2>

    <div class="body">
      <div class="p">Greenplum数据库<samp class="ph codeph">jsonb</samp>数据类型，支持GIN, btree,和hash索引。<ul class="ul" id="topic_aqt_1tw_mq__ul_mqh_pq2_rfb">
          <li class="li"><a class="xref" href="#topic_yjx_dq2_rfb">jsonb数据上的GIN索引</a></li>

          <li class="li"><a class="xref" href="#topic_ahb_5ly_wq">jsonb数据上的树索引和哈希索引</a></li>

        </ul>
</div>

    </div>

    <div class="topic nested2" id="topic_yjx_dq2_rfb">
      <h3 class="title topictitle3">jsonb数据上的GIN索引</h3>

      <div class="body">
        <p class="p">可以使用GIN索引有效地搜索出现在大量<samp class="ph codeph">jsonb</samp>文档（基准）中的键或键/值对。两个GIN操作符类，提供不同的性能和灵活性权衡。</p>

        <p class="p"><var class="keyword varname">jsonb</var>的默认GIN操作符类支持带<samp class="ph codeph">@&gt;</samp>, <samp class="ph codeph">?</samp>, <samp class="ph codeph">?&amp;</samp> 和 <samp class="ph codeph">?|</samp>操作符的查询。（有关这些运算符实现的语义的详细信息，请参见表 <a class="xref" href="#topic_o5y_14w_2z__table_dcb_y3w_mq">Table 3</a>
            ）。使用此操作符类创建索引的示例如下：</p>

        <pre class="pre codeblock">CREATE INDEX idxgin ON api USING gin (jdoc);</pre>

        <p class="p">非默认的GIN运算符类<samp class="ph codeph">jsonb_path_ops</samp>仅支持为<samp class="ph codeph">@&gt;</samp>运算符编制索引。使用此运算符类创建索引的示例如下：</p>

        <pre class="pre">CREATE INDEX idxginp ON api USING gin (jdoc jsonb_path_ops);</pre>

        <p class="p">考虑一个表的示例，该表存储从第三方Web服务检索到的JSON文档，并且具有文档化的模式定义。这是一个典型的文档：</p>

        <pre class="pre codeblock">{
    "guid": "9c36adc1-7fb5-4d5b-83b4-90356a46061a",
    "name": "Angela Barton",
    "is_active": true,
    "company": "Magnafone",
    "address": "178 Howard Place, Gulf, Washington, 702",
    "registered": "2009-11-07T08:53:22 +08:00",
    "latitude": 19.793713,
    "longitude": 86.513373,
    "tags": [
        "enim",
        "aliquip",
        "qui"
    ]
}</pre>

        <p class="p">JSON文档存储在<samp class="ph codeph">jsonb</samp>列中的一个名为API的表中。如果在此列上创建了GIN索引，则以下查询可以使用该索引：
           </p>

        <pre class="pre codeblock">-- 查找关键词“公司”具有“magnafone”价值的文档：
SELECT jdoc-&gt;'guid', jdoc-&gt;'name' FROM api WHERE jdoc @&gt; '{"company": "Magnafone"}';</pre>

        <p class="p">但是，索引不能用于以下查询。操作符<samp class="ph codeph">?</samp> 是可索引的，但是，比较不会直接应用于索引列<samp class="ph codeph">jdoc</samp>:
           </p>

        <pre class="pre codeblock">-- Find documents in which the key "tags" contains key or array element "qui"
SELECT jdoc-&gt;'guid', jdoc-&gt;'name' FROM api WHERE jdoc -&gt; 'tags' ? 'qui';</pre>

        <p class="p">通过适当地使用表达式索引，上述查询可以使用索引。如果在<samp class="ph codeph">tags</samp> 键中查询特定项是常见的，那么定义这样的索引可能是值得的：
            </p>

        <pre class="pre codeblock">CREATE INDEX idxgintags ON api USING gin ((jdoc -&gt; 'tags'));</pre>

        <p class="p">现在，<samp class="ph codeph">WHERE</samp>子句 <samp class="ph codeph">jdoc -&gt; 'tags' ? 'qui'</samp>被认为是可索引运算符的应用<samp class="ph codeph">?</samp> 到索引表达式<samp class="ph codeph">jdoc -&gt; 'tags'</samp>。有关表达式索引的信息，请参阅表达式索引
            <a class="xref" href="../../ddl/ddl-index.html#topic_tfz_3vz_4fb">表达式索引</a>。</p>

        <p class="p">查询JSON文档的另一种方法是利用包含性，例如：</p>

        <pre class="pre">-- 查找键“tags”包含数组元素"qui"的文档
            SELECT jdoc-&gt;'guid', jdoc-&gt;'name' FROM api WHERE jdoc @&gt; '{"tags": ["qui"]}';
</pre>

        <p class="p"><samp class="ph codeph">jdoc</samp>列上的一个简单的GIN索引可以支持这个查询。但是，索引将在<samp class="ph codeph">jdoc</samp>列中存储每个键和值的副本，而前一个示例的表达式索引只存储标记键下的数据。虽然简单索引方法要灵活得多（因为它支持关于任何键的查询），但是目标表达式索引可能比简单索引更小，搜索速度更快。
           </p>

        <p class="p">尽管 <samp class="ph codeph">jsonb_path_ops</samp>类只支持带<samp class="ph codeph">@&gt;</samp> 运算符的查询，但它比默认的jsonb_operator类具有性能优势。对于相同的数据， <samp class="ph codeph">jsonb_path_ops</samp>索引通常比jsonb_ops索引小得多，搜索的特殊性更好，尤其是当查询包含频繁出现在数据中的键时。因此，搜索操作通常比默认的operator类执行得更好。
          </p>

        <p class="p"> <samp class="ph codeph">jsonb_ops</samp> 和 <samp class="ph codeph">jsonb-path-ops-gin</samp> 索引的技术区别在于前者为数据中的每个键和值创建独立的索引项，而后者仅为数据中的每个值创建索引项。
     </p>

        <div class="note note">
<span class="notetitle">Note:</span> 对于这个讨论，术语<em class="ph i">value</em>包括数组元素，尽管JSON术语有时考虑数组元素不同于对象中的值。
          </div>

        <p class="p">基本上，每个<samp class="ph codeph">jsonb_path_ops</samp>索引项都是值的散列和指向该值的键；例如，要索引<samp class="ph codeph">{"foo": {"bar": "baz"}}</samp>，将创建一个索引项，将<samp class="ph codeph">foo</samp>,
            <samp class="ph codeph">bar</samp>, 和<samp class="ph codeph">baz</samp>
          中的三个都合并到散列值中。因此，查找此结构的包含查询将导致极其具体的索引搜索；但根本无法确定foo是否显示为键。另一方面，<samp class="ph codeph">jsonb_ops</samp> 索引将分别创建三个表示<samp class="ph codeph">foo</samp>,
          <samp class="ph codeph">bar</samp>, 和<samp class="ph codeph">baz</samp> 的索引项；然后，为了执行包含性查询，它将查找包含这三个项的行。虽然GIN索引可以相当有效地执行这样的搜索，但是它仍然比同等的<samp class="ph codeph">jsonb_path_ops</samp>搜索更不具体和更慢，特别是如果有大量的行包含三个索引项中的任何一个。
           </p>

        <p class="p"><samp class="ph codeph">jsonb_path_ops</samp>方法的一个缺点是它不会为不包含任何值的json结构生成索引项，例如<samp class="ph codeph">{"a":{}}</samp>：。如果请求搜索包含此类结构的文档，则需要进行完全索引扫描，这非常慢。<samp class="ph codeph">jsonb_path_ops</samp>不适合经常执行这种搜索的应用程序。
   </p>

      </div>

    </div>

    <div class="topic nested2" id="topic_ahb_5ly_wq">
      <h3 class="title topictitle3">jsonb数据上的树索引和哈希索引</h3>

      <div class="body">
        <p class="p"><samp class="ph codeph">jsonb</samp>还支持<samp class="ph codeph">btree</samp>和<samp class="ph codeph">hash</samp>索引。只有在检查完整JSON文档的相等性很重要时，这些方法才有用。
           </p>

        <p class="p">为完整起见，<samp class="ph codeph">josonb</samp> 基准的<samp class="ph codeph">btree</samp> 排序是：
           </p>

        <pre class="pre">Object &gt; Array &gt; Boolean &gt; Number &gt; String &gt; Null

Object with n pairs &gt; object with n - 1 pairs

Array with n elements &gt; array with n - 1 elements</pre>

        <p class="p">相等键值数的对象按以下顺序进行比较：</p>

        <pre class="pre">key-1, value-1, key-2 ...</pre>

        <p class="p">对象键按存储顺序进行比较。特别是，由于较短的键存储在较长的键之前，这可能导致顺序不直观，例如：
           </p>

        <pre class="pre">{ "aa": 1, "c": 1} &gt; {"b": 1, "d": 1}</pre>

        <p class="p">同样，元素数目相等的数组按以下顺序进行比较：</p>

        <pre class="pre">element-1, element-2 ...</pre>

        <p class="p">使用与底层Greenplum数据库数据类型相同的比较规则来比较原始JSON值。使用默认数据库排序规则比较字符串。
            </p>

      </div>

    </div>

  </div>

  <div class="topic nested1" id="topic_gn4_x3w_mq">
    <h2 class="title topictitle2">JSON函数和操作符</h2>

    <div class="body">
      <div class="p">Greenplum数据库包含创建和操作JSON数据的内置函数和运算符。<ul class="ul" id="topic_gn4_x3w_mq__ul_ypx_f4w_2z">
          <li class="li"><a class="xref" href="#topic_o5y_14w_2z">JSON操作符</a></li>

          <li class="li"><a class="xref" href="#topic_u4s_wnw_2z">JSON创建函数</a></li>

          <li class="li"><a class="xref" href="#topic_rvp_lk3_sfb">JSON聚合函数</a></li>

          <li class="li"><a class="xref" href="#topic_z5d_snw_2z">JSON处理函数</a></li>

        </ul>
</div>

      <div class="note note">
<span class="notetitle">Note:</span> 对于<samp class="ph codeph">json</samp>数据类型值，即使JSON对象包含重复的键，也会保留所有键/值对。对于重复的键，JSON处理函数将最后一个值视为可操作的值。对于JSONB数据类型，不保留重复的对象键。如果输入包含重复键，则只保留最后一个值。请参见<a class="xref" href="#topic_upc_tcs_fz">关于JSON数据</a>。</div>

    </div>

    <div class="topic nested2" id="topic_o5y_14w_2z">
      <h3 class="title topictitle3">JSON操作符</h3>

      <div class="body">
        <p class="p">这个表格描述了可以用于<samp class="ph codeph">json</samp> 和 <samp class="ph codeph">jsonb</samp> 数据类型的操作符。
        </p>

        
<div class="tablenoborder">
<table cellpadding="4" cellspacing="0" summary="" id="topic_o5y_14w_2z__table_e41_y3w_mq" class="table" frame="border" border="1" rules="all">
<caption><span class="tablecap">Table 2. <var class="keyword varname">json</var> 和 <samp class="ph codeph">jsonb</samp> 操作符</span></caption>
            
            
            
            
            
            <thead class="thead" align="left">
              <tr class="row">
                <th class="entry" valign="top" width="10.351966873706003%" id="d87184e896">操作符</th>

                <th class="entry" valign="top" width="12.111801242236025%" id="d87184e899">右操作数类型</th>

                <th class="entry" valign="top" width="28.88198757763975%" id="d87184e902">描述</th>

                <th class="entry" valign="top" width="28.778467908902687%" id="d87184e905">例子</th>

                <th class="entry" valign="top" width="19.875776397515526%" id="d87184e908">例子结果</th>

              </tr>

            </thead>

            <tbody class="tbody">
              <tr class="row">
                <td class="entry" valign="top" width="10.351966873706003%" headers="d87184e896 ">
                  <samp class="ph codeph">-&gt;</samp>
                </td>

                <td class="entry" valign="top" width="12.111801242236025%" headers="d87184e899 ">
                  <samp class="ph codeph">int</samp>
                </td>

                <td class="entry" valign="top" width="28.88198757763975%" headers="d87184e902 ">获得JSON数组元素（索引从零开始）。</td>

                <td class="entry" valign="top" width="28.778467908902687%" headers="d87184e905 ">
                  <samp class="ph codeph">'[{"a":"foo"},{"b":"bar"},{"c":"baz"}]'::json-&gt;2</samp>
                </td>

                <td class="entry" valign="top" width="19.875776397515526%" headers="d87184e908 ">
                  <samp class="ph codeph">{"c":"baz"}</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="10.351966873706003%" headers="d87184e896 ">
                  <samp class="ph codeph">-&gt;</samp>
                </td>

                <td class="entry" valign="top" width="12.111801242236025%" headers="d87184e899 ">
                  <samp class="ph codeph">text</samp>
                </td>

                <td class="entry" valign="top" width="28.88198757763975%" headers="d87184e902 ">根据键获得JSON对象的域。</td>

                <td class="entry" valign="top" width="28.778467908902687%" headers="d87184e905 ">
                  <samp class="ph codeph">'{"a": {"b":"foo"}}'::json-&gt;'a'</samp>
                </td>

                <td class="entry" valign="top" width="19.875776397515526%" headers="d87184e908 ">
                  <samp class="ph codeph">{"b":"foo"}</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="10.351966873706003%" headers="d87184e896 ">
                  <samp class="ph codeph">-&gt;&gt;</samp>
                </td>

                <td class="entry" valign="top" width="12.111801242236025%" headers="d87184e899 ">
                  <samp class="ph codeph">int</samp>
                </td>

                <td class="entry" valign="top" width="28.88198757763975%" headers="d87184e902 ">	获得JSON数组元素的<samp class="ph codeph">text</samp>形式。</td>

                <td class="entry" valign="top" width="28.778467908902687%" headers="d87184e905 ">
                  <samp class="ph codeph">'[1,2,3]'::json-&gt;&gt;2</samp>
                </td>

                <td class="entry" valign="top" width="19.875776397515526%" headers="d87184e908 ">
                  <samp class="ph codeph">3</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="10.351966873706003%" headers="d87184e896 ">
                  <samp class="ph codeph">-&gt;&gt;</samp>
                </td>

                <td class="entry" valign="top" width="12.111801242236025%" headers="d87184e899 ">
                  <samp class="ph codeph">text</samp>
                </td>

                <td class="entry" valign="top" width="28.88198757763975%" headers="d87184e902 ">获得JSON对象域的<samp class="ph codeph">text</samp>形式。</td>

                <td class="entry" valign="top" width="28.778467908902687%" headers="d87184e905 ">
                  <samp class="ph codeph">'{"a":1,"b":2}'::json-&gt;&gt;'b'</samp>
                </td>

                <td class="entry" valign="top" width="19.875776397515526%" headers="d87184e908 ">
                  <samp class="ph codeph">2</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="10.351966873706003%" headers="d87184e896 ">
                  <samp class="ph codeph">#&gt;</samp>
                </td>

                <td class="entry" valign="top" width="12.111801242236025%" headers="d87184e899 ">
                  <samp class="ph codeph">text[]</samp>
                </td>

                <td class="entry" valign="top" width="28.88198757763975%" headers="d87184e902 ">获得在指定路径上的JSON对象。</td>

                <td class="entry" valign="top" width="28.778467908902687%" headers="d87184e905 ">
<samp class="ph codeph">'{"a": {"b":{"c": "foo"}}}'::json#&gt;'{a,b}</samp>'</td>

                <td class="entry" valign="top" width="19.875776397515526%" headers="d87184e908 ">
                  <samp class="ph codeph">{"c": "foo"}</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="10.351966873706003%" headers="d87184e896 ">
                  <samp class="ph codeph">#&gt;&gt;</samp>
                </td>

                <td class="entry" valign="top" width="12.111801242236025%" headers="d87184e899 ">
                  <samp class="ph codeph">text[]</samp>
                </td>

                <td class="entry" valign="top" width="28.88198757763975%" headers="d87184e902 ">获得在指定路径上的JSON对象的<samp class="ph codeph">text</samp>形式。</td>

                <td class="entry" valign="top" width="28.778467908902687%" headers="d87184e905 ">
                  <samp class="ph codeph">'{"a":[1,2,3],"b":[4,5,6]}'::json#&gt;&gt;'{a,2}'</samp>
                </td>

                <td class="entry" valign="top" width="19.875776397515526%" headers="d87184e908 ">
                  <samp class="ph codeph">3</samp>
                </td>

              </tr>

            </tbody>

          </table>
</div>

        <div class="note note">
<span class="notetitle">Note:</span> 对于<samp class="ph codeph">json</samp>和<samp class="ph codeph">jsonb</samp>数据类型，这些运算符都有并行变体。字段、元素和路径提取运算符返回的数据类型与其左侧输入（<samp class="ph codeph">json</samp>和<samp class="ph codeph">jsonb</samp>）相同，但指定为返回<samp class="ph codeph">text</samp>的数据类型除外，后者将值强制为<samp class="ph codeph">text</samp>。如果JSON输入没有与请求匹配的正确结构，则字段、元素和路径提取运算符返回<samp class="ph codeph">NULL</samp>，而不是失败；例如，如果不存在这样的元素。
          </div>

        <p class="p">下表描述了需要<samp class="ph codeph">jsonb</samp>数据类型作为左操作数的运算符。这些运算符中的许多都可以通过<samp class="ph codeph">jsonb</samp>运算符类进行索引。有关<samp class="ph codeph">jsonb</samp>包含和存在语义的完整描述，请参见<a class="xref" href="#topic_isx_2tw_mq">jsonb容器与存在</a>。有关如何使用这些运算符有效地索引JSONB数据的信息，请参阅<a class="xref" href="#topic_aqt_1tw_mq">jsonb索引</a>。</p>

        
<div class="tablenoborder">
<table cellpadding="4" cellspacing="0" summary="" id="topic_o5y_14w_2z__table_dcb_y3w_mq" class="table" frame="border" border="1" rules="all">
<caption><span class="tablecap">Table 3. <samp class="ph codeph">jsonb</samp>操作符</span></caption>
            
            
            
            
            <thead class="thead" align="left">
              <tr class="row">
                <th class="entry" valign="top" width="9.970089730807578%" id="d87184e1173">操作符</th>

                <th class="entry" valign="top" width="19.3419740777667%" id="d87184e1176">右操作数类型</th>

                <th class="entry" valign="top" width="45.76271186440678%" id="d87184e1179">描述</th>

                <th class="entry" valign="top" width="24.925224327018945%" id="d87184e1182">例子</th>

              </tr>

            </thead>

            <tbody class="tbody">
              <tr class="row">
                <td class="entry" valign="top" width="9.970089730807578%" headers="d87184e1173 ">
                  <samp class="ph codeph">@&gt;</samp>
                </td>

                <td class="entry" valign="top" width="19.3419740777667%" headers="d87184e1176 ">
                  <samp class="ph codeph">jsonb</samp>
                </td>

                <td class="entry" valign="top" width="45.76271186440678%" headers="d87184e1179 ">左边的json值包含右边的值吗？</td>

                <td class="entry" valign="top" width="24.925224327018945%" headers="d87184e1182 ">
                  <samp class="ph codeph">'{"a":1, "b":2}'::jsonb @&gt; '{"b":2}'::jsonb</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="9.970089730807578%" headers="d87184e1173 ">
                  <samp class="ph codeph">&lt;@</samp>
                </td>

                <td class="entry" valign="top" width="19.3419740777667%" headers="d87184e1176 ">
                  <samp class="ph codeph">jsonb</samp>
                </td>

                <td class="entry" valign="top" width="45.76271186440678%" headers="d87184e1179 ">左JSON值是否包含在右值中？</td>

                <td class="entry" valign="top" width="24.925224327018945%" headers="d87184e1182 ">
                  <samp class="ph codeph">'{"b":2}'::jsonb &lt;@ '{"a":1, "b":2}'::jsonb</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="9.970089730807578%" headers="d87184e1173 ">
                  <samp class="ph codeph">?</samp>
                </td>

                <td class="entry" valign="top" width="19.3419740777667%" headers="d87184e1176 ">
                  <samp class="ph codeph">text</samp>
                </td>

                <td class="entry" valign="top" width="45.76271186440678%" headers="d87184e1179 ">键/元素字符串是否存在于JSON值中？</td>

                <td class="entry" valign="top" width="24.925224327018945%" headers="d87184e1182 ">
                  <samp class="ph codeph">'{"a":1, "b":2}'::jsonb ? 'b'</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="9.970089730807578%" headers="d87184e1173 ">
                  <samp class="ph codeph">?|</samp>
                </td>

                <td class="entry" valign="top" width="19.3419740777667%" headers="d87184e1176 ">
                  <samp class="ph codeph">text[]</samp>
                </td>

                <td class="entry" valign="top" width="45.76271186440678%" headers="d87184e1179 ">是否存在这些键/元素字符串？</td>

                <td class="entry" valign="top" width="24.925224327018945%" headers="d87184e1182 ">
                  <samp class="ph codeph">'{"a":1, "b":2, "c":3}'::jsonb ?| array['b', 'c']</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="9.970089730807578%" headers="d87184e1173 ">
                  <samp class="ph codeph">?&amp;</samp>
                </td>

                <td class="entry" valign="top" width="19.3419740777667%" headers="d87184e1176 ">
                  <samp class="ph codeph">text[]</samp>
                </td>

                <td class="entry" valign="top" width="45.76271186440678%" headers="d87184e1179 ">所有这些键/元素字符串都存在吗？</td>

                <td class="entry" valign="top" width="24.925224327018945%" headers="d87184e1182 ">
                  <samp class="ph codeph">'["a", "b"]'::jsonb ?&amp; array['a', 'b']</samp>
                </td>

              </tr>

            </tbody>

          </table>
</div>

        <p class="p">下表中的标准比较运算符仅适用于 <samp class="ph codeph">jsonb</samp>数据类型，而不适用于 <samp class="ph codeph">json</samp>数据类型。它们遵循 <samp class="ph codeph">jsonb</samp>索引<a class="xref" href="#topic_aqt_1tw_mq">jsonb索引</a>中描述的B树操作的排序规则。</p>

        
<div class="tablenoborder">
<table cellpadding="4" cellspacing="0" summary="" id="topic_o5y_14w_2z__table_j4w_z5n_vq" class="table" frame="border" border="1" rules="all">
<caption><span class="tablecap">Table 4. <samp class="ph codeph">jsonb</samp> 比较运算符</span></caption>
            
            
            <thead class="thead" align="left">
              <tr class="row">
                <th class="entry" valign="top" id="d87184e1347">操作符</th>

                <th class="entry" valign="top" id="d87184e1350">描述</th>

              </tr>

            </thead>

            <tbody class="tbody">
              <tr class="row">
                <td class="entry" valign="top" headers="d87184e1347 ">
                  <samp class="ph codeph">&lt;</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1350 ">小于</td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" headers="d87184e1347 ">
                  <samp class="ph codeph">&gt;</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1350 ">大于</td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" headers="d87184e1347 ">
                  <samp class="ph codeph">&lt;=</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1350 ">小于或等于</td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" headers="d87184e1347 ">
                  <samp class="ph codeph">&gt;=</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1350 ">大于或等于</td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" headers="d87184e1347 ">
                  <samp class="ph codeph">=</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1350 ">等于</td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" headers="d87184e1347 ">
<samp class="ph codeph">&lt;&gt;</samp>或者<samp class="ph codeph">!=</samp>
</td>

                <td class="entry" valign="top" headers="d87184e1350 ">不等于</td>

              </tr>

            </tbody>

          </table>
</div>

        <div class="note note">
<span class="notetitle">Note:</span> 这个<samp class="ph codeph">!=</samp>运算符在解析阶段转换为 <samp class="ph codeph">&lt;&gt;</samp>。无法执行 <samp class="ph codeph">!=</samp>和<samp class="ph codeph">&lt;&gt;</samp>来执行不同操作的运算符。
           </div>

      </div>

    </div>

    <div class="topic nested2" id="topic_u4s_wnw_2z">
      <h3 class="title topictitle3">JSON创建函数</h3>

      <div class="body">
        <p class="p">此表描述了创建 <samp class="ph codeph">json</samp>数据类型值的函数。（目前， <samp class="ph codeph">jsonb</samp>没有等价的函数，但是您可以将其中一个函数的结果强制转换为 <samp class="ph codeph">jsonb</samp>。）
      </p>

        
<div class="tablenoborder">
<table cellpadding="4" cellspacing="0" summary="" id="topic_u4s_wnw_2z__table_sqb_y3w_mb" class="table" frame="border" border="1" rules="all">
<caption><span class="tablecap">Table 5. JSON创建函数</span></caption>
            
            
            
            
            <thead class="thead" align="left">
              <tr class="row">
                <th class="entry" valign="top" id="d87184e1489">函数</th>

                <th class="entry" valign="top" id="d87184e1492">描述</th>

                <th class="entry" valign="top" id="d87184e1495">例子</th>

                <th class="entry" valign="top" id="d87184e1498">例子结果</th>

              </tr>

            </thead>

            <tbody class="tbody">
              <tr class="row">
                <td class="entry" valign="top" headers="d87184e1489 ">
                  <samp class="ph codeph">to_json(anyelement)</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1492 ">返回该值作为一个合法的JSON对象。
                    数组和组合会被递归处理并且转换成数组和对象。如果输入包含一个从该类型到 <samp class="ph codeph">json</samp>的转换，会使用该cast函数来执行转换，否则将会产生一个JSON标量值。对于任何非数字、布尔值或空值的标量类型，会使用其文本表示，并且加上适当的引号和转义让它变成一个合法的JSON字符串。
                   </td>

                <td class="entry" valign="top" headers="d87184e1495 ">
                  <samp class="ph codeph">to_json('Fred said "Hi."'::text)</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1498 ">
                  <samp class="ph codeph">"Fred said \"Hi.\""</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" headers="d87184e1489 ">
                  <samp class="ph codeph">array_to_json(anyarray [, pretty_bool])</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1492 ">返回该数组为一个JSON数组。一个Greenplum数据库多维数组会变成一个JSON数组的数组。<p class="p">如果<samp class="ph codeph">pretty_bool</samp> 为true，在第一维元素之间会增加换行。</p>
</td>

                <td class="entry" valign="top" headers="d87184e1495 ">
                  <samp class="ph codeph">array_to_json('{{1,5},{99,100}}'::int[])</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1498 ">
                  <samp class="ph codeph">[[1,5],[99,100]]</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" headers="d87184e1489 ">
                  <samp class="ph codeph">row_to_json(record [, pretty_bool])</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1492 ">返回该行为一个JSON对象。 <p class="p">如果<samp class="ph codeph">pretty_bool</samp> pretty_bool为true，在第一级别元素之间会增加换行。</p>
</td>

                <td class="entry" valign="top" headers="d87184e1495 ">
                  <samp class="ph codeph">row_to_json(row(1,'foo'))</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1498 ">
                  <samp class="ph codeph">{"f1":1,"f2":"foo"}</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" headers="d87184e1489 ">
<samp class="ph codeph">json_build_array(VARIADIC "any"</samp>)</td>

                <td class="entry" valign="top" headers="d87184e1492 ">从<samp class="ph codeph">VARIADIC</samp> 参数列表构建一个可能是异种类型的JSON数组。
                   </td>

                <td class="entry" valign="top" headers="d87184e1495 ">
                  <samp class="ph codeph">json_build_array(1,2,'3',4,5)</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1498 ">
                  <samp class="ph codeph">[1, 2, "3", 4, 5]</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" headers="d87184e1489 ">
                  <samp class="ph codeph">json_build_object(VARIADIC "any")</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1492 ">从<samp class="ph codeph">VARIADIC</samp>参数列表构建JSON对象。参数列表按顺序获取，并转换为一组键/值对。
                   </td>

                <td class="entry" valign="top" headers="d87184e1495 ">
                  <samp class="ph codeph">json_build_object('foo',1,'bar',2)</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1498 ">
                  <samp class="ph codeph">{"foo": 1, "bar": 2}</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" headers="d87184e1489 ">
                  <samp class="ph codeph">json_object(text[])</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1492 ">从文本数组构建JSON对象。数组必须是一维或二维数组。
                 <p class="p">一维数组必须有偶数个元素。元素作为键/值对。</p>
<p class="p">对于二维数组，每个内部数组必须恰好有两个元素，作为键/值对。</p>
</td>

                <td class="entry" valign="top" headers="d87184e1495 ">
                  <p class="p">
                    <samp class="ph codeph">json_object('{a, 1, b, "def", c, 3.5}')</samp>
                  </p>

                  <p class="p">
                    <samp class="ph codeph">json_object('{{a, 1},{b, "def"},{c, 3.5}}')</samp>
                  </p>

                </td>

                <td class="entry" valign="top" headers="d87184e1498 ">
                  <samp class="ph codeph">{"a": "1", "b": "def", "c": "3.5"}</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" headers="d87184e1489 ">
                  <samp class="ph codeph">json_object(keys text[], values text[])</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1492 ">从文本阵列中创建JSON对象。这一形式的<samp class="ph codeph">json_object</samp>对象从两个分隔阵列中选择了键和值对。在所有其他方面，它与一个论据形式相同。
                  </td>

                <td class="entry" valign="top" headers="d87184e1495 ">
                  <samp class="ph codeph">json_object('{a, b}', '{1,2}')</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1498 ">
                  <samp class="ph codeph">{"a": "1", "b": "2"}</samp>
                </td>

              </tr>

            </tbody>

          </table>
</div>

        <div class="note note">
<span class="notetitle">Note:</span> <samp class="ph codeph">array_to_json</samp>和<samp class="ph codeph">row_to_json</samp>的行为与<samp class="ph codeph">to_json</samp> 相同，只是提供了一个打印漂亮的选项。to_json描述的行为同样适用于其他JSON创建函数转换的每个单独的值。
 </div>

        <div class="note note">
<span class="notetitle">Note:</span> <a class="xref" href="../../../ref_guide/modules/hstore.html#topic_vcn_jkq_1bb">hstore</a><samp class="ph codeph">hstore</samp>模块包含从<samp class="ph codeph">hstore</samp>转换为<samp class="ph codeph">json</samp>的函数，因此通过<samp class="ph codeph">json</samp>创建函数转换的<samp class="ph codeph">hstore</samp>值将被表示为json对象，而不是原始字符串值。
        </div>

      </div>

    </div>

    <div class="topic nested2" id="topic_rvp_lk3_sfb">
      <h3 class="title topictitle3">JSON聚合函数</h3>

      <div class="body">
        <p class="p">此表显示函数将记录聚合到一个JSON对象数组和一对JSON对象的值。
   </p>

        
<div class="tablenoborder">
<table cellpadding="4" cellspacing="0" summary="" id="topic_rvp_lk3_sfb__table_kkr_mk3_sfb" class="table" frame="border" border="1" rules="all">
<caption><span class="tablecap">Table 6. JSON聚合函数</span></caption>
            
            
            
            
            <thead class="thead" align="left">
              <tr class="row">
                <th class="entry" valign="top" id="d87184e1774">函数</th>

                <th class="entry" valign="top" id="d87184e1777">参数类型</th>

                <th class="entry" valign="top" id="d87184e1780">返回类型</th>

                <th class="entry" valign="top" id="d87184e1783">描述</th>

              </tr>

            </thead>

            <tbody class="tbody">
              <tr class="row">
                <td class="entry" valign="top" headers="d87184e1774 ">
                  <samp class="ph codeph">json_agg(record)</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1777 ">
                  <samp class="ph codeph">record</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1780 ">
                  <samp class="ph codeph">json</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1783 ">将记录聚合为对象的JSON数组。</td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" headers="d87184e1774 ">
                  <samp class="ph codeph">json_object_agg(name, value)</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1777 ">
                  <samp class="ph codeph">("any", "any")</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1780 ">
                  <samp class="ph codeph">json</samp>
                </td>

                <td class="entry" valign="top" headers="d87184e1783 ">将名称/值对聚合为JSON对象。</td>

              </tr>

            </tbody>

          </table>
</div>

      </div>

    </div>

    <div class="topic nested2" id="topic_z5d_snw_2z">
      <h3 class="title topictitle3">JSON处理函数</h3>

      <div class="body">
        <p class="p">这个表描述处理<samp class="ph codeph">json</samp>
          和 <samp class="ph codeph">jsonb</samp>值的函数。</p>

        <p class="p">许多处理函数和运算符将JSON字符串中的Unicode转义符转换为适当的单个字符。如果输入数据类型是<samp class="ph codeph">jsonb</samp>，这不是问题，因为转换已经完成。但是，对于<samp class="ph codeph">json</samp>数据类型输入，这可能导致抛出错误。请参见关于
            <a class="xref" href="#topic_upc_tcs_fz">关于JSON数据</a>。</p>

        
<div class="tablenoborder">
<table cellpadding="4" cellspacing="0" summary="" id="topic_z5d_snw_2z__table_wfc_y3w_mb" class="table" frame="border" border="1" rules="all">
<caption><span class="tablecap">Table 7. JSON处理函数</span></caption>
            
            
            
            
            
            <thead class="thead" align="left">
              <tr class="row">
                <th class="entry" valign="top" width="20.224719101123597%" id="d87184e1896">函数</th>

                <th class="entry" valign="top" width="18.726591760299627%" id="d87184e1899">返回类型</th>

                <th class="entry" valign="top" width="18.913857677902623%" id="d87184e1902">描述</th>

                <th class="entry" valign="top" width="23.220973782771537%" id="d87184e1905">例子</th>

                <th class="entry" valign="top" width="18.913857677902623%" id="d87184e1908">例子结果</th>

              </tr>

            </thead>

            <tbody class="tbody">
              <tr class="row">
                <td class="entry" valign="top" width="20.224719101123597%" headers="d87184e1896 ">
                  <samp class="ph codeph">json_array_length(json)</samp>
                  <p class="p">
                    <samp class="ph codeph">jsonb_array_length(jsonb)</samp>
                  </p>
</td>

                <td class="entry" valign="top" width="18.726591760299627%" headers="d87184e1899 ">
<samp class="ph codeph">int</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1902 ">返回最外层JSON数组中的元素数。</td>

                <td class="entry" valign="top" width="23.220973782771537%" headers="d87184e1905 ">
<samp class="ph codeph">json_array_length('[1,2,3,{"f1":1,"f2":[5,6]},4]')</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1908 ">
                  <samp class="ph codeph">5</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="20.224719101123597%" headers="d87184e1896 ">
<samp class="ph codeph">json_each(json)</samp>
                  <p class="p"><samp class="ph codeph">jsonb_each(jsonb)</samp>
                  </p>
</td>

                <td class="entry" valign="top" width="18.726591760299627%" headers="d87184e1899 ">
<samp class="ph codeph">setof key text, value json</samp>
                  <p class="p"><samp class="ph codeph">setof key text, value jsonb</samp>
                  </p>

                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1902 ">将最外层的JSON对象展开为一组键/值对。</td>

                <td class="entry" valign="top" width="23.220973782771537%" headers="d87184e1905 ">
<samp class="ph codeph">select * from json_each('{"a":"foo", "b":"bar"}')</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1908 ">
                  <pre class="pre"> key | value
-----+-------
 a   | "foo"
 b   | "bar"
</pre>

                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="20.224719101123597%" headers="d87184e1896 ">
<samp class="ph codeph">json_each_text(json)</samp>
                  <p class="p"><samp class="ph codeph">jsonb_each_text(jsonb)</samp>
                  </p>

                </td>

                <td class="entry" valign="top" width="18.726591760299627%" headers="d87184e1899 ">
<samp class="ph codeph">setof key text, value text</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1902 ">把最外层的JSON对象展开成键/值对的集合。返回值的类型是<samp class="ph codeph">text</samp>。</td>

                <td class="entry" valign="top" width="23.220973782771537%" headers="d87184e1905 ">
<samp class="ph codeph">select * from json_each_text('{"a":"foo", "b":"bar"}')</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1908 ">
                  <pre class="pre"> key | value
-----+-------
 a   | foo
 b   | bar
</pre>

                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="20.224719101123597%" headers="d87184e1896 ">
<samp class="ph codeph">json_extract_path(from_json json, VARIADIC path_elems
                    text[])</samp>
                  <p class="p"><samp class="ph codeph">jsonb_extract_path(from_json jsonb, VARIADIC path_elems
                      text[])</samp>
                  </p>
</td>

                <td class="entry" valign="top" width="18.726591760299627%" headers="d87184e1899 ">
                  <p class="p"><samp class="ph codeph">json</samp>
                  </p>

                  <p class="p"><samp class="ph codeph">jsonb</samp>
                  </p>

                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1902 ">	返回<samp class="ph codeph">path_elems</samp>指定的JSON值。等效于<samp class="ph codeph">#&gt;</samp>操作符。
               </td>

                <td class="entry" valign="top" width="23.220973782771537%" headers="d87184e1905 ">
<samp class="ph codeph">json_extract_path('{"f2":{"f3":1},"f4":{"f5":99,"f6":"foo"}}','f4')</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1908 ">
                  <samp class="ph codeph">{"f5":99,"f6":"foo"}</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="20.224719101123597%" headers="d87184e1896 ">
<samp class="ph codeph">json_extract_path_text(from_json json, VARIADIC path_elems
                    text[])</samp>
                  <p class="p"><samp class="ph codeph">jsonb_extract_path_text(from_json jsonb, VARIADIC path_elems
                      text[])</samp>
                  </p>
</td>

                <td class="entry" valign="top" width="18.726591760299627%" headers="d87184e1899 ">
<samp class="ph codeph">text</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1902 ">以文本形式返回<samp class="ph codeph">path_elems</samp>指向的JSON值。相当于&gt;&gt;运算符。</td>

                <td class="entry" valign="top" width="23.220973782771537%" headers="d87184e1905 ">
<samp class="ph codeph">json_extract_path_text('{"f2":{"f3":1},"f4":{"f5":99,"f6":"foo"}}','f4',
                    'f6')</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1908 ">
                  <samp class="ph codeph">foo</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="20.224719101123597%" headers="d87184e1896 ">
<samp class="ph codeph">json_object_keys(json)</samp>
                  <p class="p"><samp class="ph codeph">jsonb_object_keys(jsonb)</samp>
                  </p>
</td>

                <td class="entry" valign="top" width="18.726591760299627%" headers="d87184e1899 ">
<samp class="ph codeph">setof text</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1902 ">返回最外层JSON对象中的键集合。</td>

                <td class="entry" valign="top" width="23.220973782771537%" headers="d87184e1905 ">
<samp class="ph codeph">json_object_keys('{"f1":"abc","f2":{"f3":"a", "f4":"b"}}')</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1908 ">
                  <pre class="pre"> json_object_keys
------------------
 f1
 f2
</pre>

                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="20.224719101123597%" headers="d87184e1896 ">
<samp class="ph codeph">json_populate_record(base anyelement, from_json
                      json)</samp><p class="p"><samp class="ph codeph">jsonb_populate_record(base anyelement, from_json
                      jsonb)</samp>
                  </p>
</td>

                <td class="entry" valign="top" width="18.726591760299627%" headers="d87184e1899 ">
<samp class="ph codeph">anyelement</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1902 ">把<samp class="ph codeph">from_json</samp>的对象展开成一行，其中的列匹配由base定义的记录类型。请见注解<a class="xref" href="#topic_z5d_snw_2z__json_proc_1">Note 1</a>。</td>

                <td class="entry" valign="top" width="23.220973782771537%" headers="d87184e1905 ">
<samp class="ph codeph">select * from json_populate_record(null::myrowtype,
                    '{"a":1,"b":2}')</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1908 ">
                  <pre class="pre"> a | b
---+---
 1 | 2
</pre>

                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="20.224719101123597%" headers="d87184e1896 ">
<samp class="ph codeph">json_populate_recordset(base anyelement, from_json json)</samp>
                  <p class="p"><samp class="ph codeph">jsonb_populate_recordset(base anyelement, from_json jsonb)</samp>
                  </p>
</td>

                <td class="entry" valign="top" width="18.726591760299627%" headers="d87184e1899 ">
<samp class="ph codeph">setof anyelement</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1902 ">将<samp class="ph codeph">from_json</samp>的最外层数组从\ujson扩展到一组行，这些行的列与基定义的记录类型匹配。见
               <a class="xref" href="#topic_z5d_snw_2z__json_proc_1">Note 1</a>.</td>

                <td class="entry" valign="top" width="23.220973782771537%" headers="d87184e1905 ">
<samp class="ph codeph">select * from json_populate_recordset(null::myrowtype,
                    '[{"a":1,"b":2},{"a":3,"b":4}]')</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1908 ">
                  <pre class="pre"> a | b
---+---
 1 | 2
 3 | 4
</pre>

                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="20.224719101123597%" headers="d87184e1896 ">
<samp class="ph codeph">json_array_elements(json)</samp>
                  <p class="p"><samp class="ph codeph">jsonb_array_elements(jsonb</samp>)</p>
</td>

                <td class="entry" valign="top" width="18.726591760299627%" headers="d87184e1899 ">
                  <p class="p"><samp class="ph codeph">setof json</samp>
                  </p>

                  <p class="p"><samp class="ph codeph">setof jsonb</samp>
                  </p>

                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1902 ">Expands a JSON array to a set of JSON values.</td>

                <td class="entry" valign="top" width="23.220973782771537%" headers="d87184e1905 ">
<samp class="ph codeph">select * from json_array_elements('[1,true, [2,false]]')</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1908 ">
                  <pre class="pre">   value
-----------
 1
 true
 [2,false]
</pre>

                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="20.224719101123597%" headers="d87184e1896 ">
<samp class="ph codeph">json_array_elements_text(json)</samp>
                  <p class="p"><samp class="ph codeph">jsonb_array_elements_text(jsonb)</samp>
                  </p>
</td>

                <td class="entry" valign="top" width="18.726591760299627%" headers="d87184e1899 ">
<samp class="ph codeph">setof text</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1902 ">Expands a JSON array to a set of <samp class="ph codeph">text</samp> values.</td>

                <td class="entry" valign="top" width="23.220973782771537%" headers="d87184e1905 ">
<samp class="ph codeph">select * from json_array_elements_text('["foo", "bar"]')</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1908 ">
                  <pre class="pre">   value
-----------
 foo
 bar
</pre>

                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="20.224719101123597%" headers="d87184e1896 ">
<samp class="ph codeph">json_typeof(json)</samp><p class="p"><samp class="ph codeph">jsonb_typeof(jsonb)</samp>
                  </p>
</td>

                <td class="entry" valign="top" width="18.726591760299627%" headers="d87184e1899 ">
<samp class="ph codeph">text</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1902 ">以文本字符串形式返回最外面的JSON值的类型。可能的类型包括<samp class="ph codeph">object</samp>, <samp class="ph codeph">array</samp>, <samp class="ph codeph">string</samp>,
                    <samp class="ph codeph">number</samp>, <samp class="ph codeph">boolean</samp>, 和 <samp class="ph codeph">null</samp>.
                  See <a class="xref" href="#topic_z5d_snw_2z__json_proc_2">Note
                  2</a>.</td>

                <td class="entry" valign="top" width="23.220973782771537%" headers="d87184e1905 ">
<samp class="ph codeph">json_typeof('-123.4')</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1908 ">
                  <samp class="ph codeph">number</samp>
                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="20.224719101123597%" headers="d87184e1896 ">
<samp class="ph codeph">json_to_record(json)</samp><p class="p"><samp class="ph codeph">jsonb_to_record(jsonb)</samp>
                  </p>
</td>

                <td class="entry" valign="top" width="18.726591760299627%" headers="d87184e1899 ">
<samp class="ph codeph">record</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1902 ">从JSON对象生成任意记录，可见<a class="xref" href="#topic_z5d_snw_2z__json_proc_1">Note 1</a>。
	 <p class="p">与所有返回记录的函数一样，调用方必须使用<samp class="ph codeph">AS</samp>子句显式定义记录的结构。 </p>
</td>

                <td class="entry" valign="top" width="23.220973782771537%" headers="d87184e1905 ">
<samp class="ph codeph">select * from json_to_record('{"a":1,"b":[1,2,3],"c":"bar"}') as x(a
                    int, b text, d text)</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1908 ">
                  <pre class="pre"> a |    b    | d
---+---------+---
 1 | [1,2,3] |
</pre>

                </td>

              </tr>

              <tr class="row">
                <td class="entry" valign="top" width="20.224719101123597%" headers="d87184e1896 ">
<samp class="ph codeph">json_to_recordset(json)</samp>
                  <p class="p"><samp class="ph codeph">jsonb_to_recordset(jsonb)</samp>
                  </p>
</td>

                <td class="entry" valign="top" width="18.726591760299627%" headers="d87184e1899 ">
<samp class="ph codeph">setof record</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1902 ">从JSON对象数组生成任意记录集，可见 <a class="xref" href="#topic_z5d_snw_2z__json_proc_1">Note 1</a>。 <p class="p">
                    与所有返回记录的函数一样，调用方必须使用<samp class="ph codeph">AS</samp> clause子句显式定义记录的结构。 </p>
</td>

                <td class="entry" valign="top" width="23.220973782771537%" headers="d87184e1905 ">
<samp class="ph codeph">select * from
                    json_to_recordset('[{"a":1,"b":"foo"},{"a":"2","c":"bar"}]') as x(a int, b
                    text);</samp>
                </td>

                <td class="entry" valign="top" width="18.913857677902623%" headers="d87184e1908 ">
                  <pre class="pre"> a |  b
---+-----
 1 | foo
 2 |
</pre>

                </td>

              </tr>

            </tbody>

          </table>
</div>

        <div class="note note" id="topic_z5d_snw_2z__json_record">
<span class="notetitle">Note:</span> 
          <ol class="ol" id="topic_z5d_snw_2z__ol_umc_2sg_pfb">
            <li class="li" id="topic_z5d_snw_2z__json_proc_1">函数<samp class="ph codeph">json_populate_record()</samp>, <samp class="ph codeph">json_populate_recordset()</samp>,
                <samp class="ph codeph">json_to_record()</samp> 和 <samp class="ph codeph">json_to_recordset()</samp>的示例使用常量。
                但是，典型的用法是引用<samp class="ph codeph">FROM</samp>子句中的表，并使用它的<samp class="ph codeph">json</samp>或<samp class="ph codeph">jsonb</samp>列之一作为函数的参数。然后可以在查询的其他部分中引用提取的键值。例如，可以在WHERE子句和目标列表中引用该值。以这种方式提取多个值可以提高性能，而不是使用每个键操作符分别提取多个值。
               <p class="p">JSON键与目标行类型中相同的列名匹配。这些函数的JSON类型强制可能不会产生某些类型所需的值。目标行类型中未出现的JSON字段将从输出中省略，不匹配任何JSON字段的目标列将为空。</p>
</li>

            <li class="li" id="topic_z5d_snw_2z__json_proc_2">
<samp class="ph codeph">json_typeof</samp>函数NULL返回值 <samp class="ph codeph">null</samp>不应与SQL<samp class="ph codeph">NULL</samp>混淆。当调用<samp class="ph codeph">json_typeof('null'::json)</samp>将返回<samp class="ph codeph">null</samp>时，调用<samp class="ph codeph">json_typeof(NULL::json)</samp>将返回SQL<samp class="ph codeph">NULL</samp>。
               </li>

          </ol>

        </div>

      </div>

    </div>

  </div>



        

      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    
  </footer>
</div><!--end of container-->

</body>
</html>
