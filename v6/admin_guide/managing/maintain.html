<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      日常系统维护任务 |
    Greenplum Database Docs
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='/images/favicon.ico' rel='shortcut icon'>

  <script src="/javascripts/all.js"></script>
  
</head>

<body class="x6-0 x6-0_admin_guide x6-0_admin_guide_managing x6-0_admin_guide_managing_maintain has-subnav">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">
      document.domain = "greenplum.org";
    </script>

     
  <header class="header header-layout">
    <h1 class="logo">
      <a href="/">Greenplum Database Documentation</a>
    </h1>
    
    <div class="header-links js-bar-links">
      <div class="btn-menu" data-behavior="MenuMobile"></div>
      <div class="header-item"><a href="https://greenplum.org">Back to Greenplum Database</a></div>
      <div class="header-item">
        <a href="https://github.com/greenplum-db/gpdb/wiki">Wiki</a>
      </div>
      
    </div>
  </header>


    <div class="container">

      <!--googleoff: index-->
      <div id="sub-nav" class="nav-container js-sidenav" role="navigation" >
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/../../6-0/homenav.html">Greenplum数据库® 6.0文档</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/admin_guide.html">管理员指南</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/intro/partI.html">Greenplum数据库概念</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/intro/arch_overview.html">关于Greenplum的架构</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/intro/about_utilities.html">关于管理和监控工具</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/intro/about_mvcc.html">关于Greenplum数据库中的并发控制</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/intro/mvcc_example.html">管理事务ID的例子</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/intro/about_loading.html">关于并行数据装载</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/intro/about_ha.html">关于Greenplum数据库中的冗余和故障切换</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/intro/about_statistics.html">关于Greenplum数据库中的数据库统计信息</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/managing/partII.html">管理一个Greenplum系统</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/versioning.html">关于Greenplum数据库发布版本号</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/startstop.html">启动和停止Greenplum数据库</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/access_db/topics/g-accessing-the-database.html">访问数据库</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/access_db/topics/g-establishing-a-database-session.html">建立一个数据库会话</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/access_db/topics/g-supported-client-applications.html">支持的客户端应用</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/access_db/topics/g-greenplum-database-client-applications.html">Greenplum数据库客户端应用</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/access_db/topics/g-connecting-with-psql.html">用psql连接</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/access_db/topics/pgbouncer.html">使用PgBouncer连接池</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/access_db/topics/g-database-application-interfaces.html">数据库应用接口</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/access_db/topics/g-troubleshooting-connection-problems.html">连接问题的发现及解决</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/topics/g-configuring-the-greenplum-system.html">配置Greenplum数据库系统</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/topics/g-about-greenplum-master-and-local-parameters.html">关于Greenplum数据库的Master参数和本地参数</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/topics/g-setting-configuration-parameters.html">设置配置参数</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/topics/g-setting-a-local-configuration-parameter.html">设置本地配置参数</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/topics/g-setting-a-master-configuration-parameter.html">设置Master配置参数</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/topics/g-setting-parameters-at-the-system-level.html">设置系统级别参数</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/topics/g-setting-parameters-at-the-database-level.html">设置数据库级别参数</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/topics/g-setting-parameters-at-the-role-level.html">设置角色级别参数</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/topics/g-setting-parameters-in-a-session.html">设置会话级别参数</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/topics/g-viewing-server-configuration-parameter-settings.html">查看服务器配置参数设置</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/topics/g-configuration-parameter-categories.html">配置参数种类</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/compression.html">启用压缩</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/highavail/topics/g-enabling-high-availability-features.html">启用高可用和数据持久化特征</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/highavail/topics/g-overview-of-high-availability-in-greenplum-database.html">Greenplum数据库高可用性概述</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/highavail/topics/g-overview-of-segment-mirroring.html">Segment镜像概述</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/highavail/topics/g-overview-of-master-mirroring.html">Master镜像概述</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/highavail/topics/g-enabling-mirroring-in-greenplum-database.html">在Greenplum数据库中启用镜像</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/highavail/topics/g-enabling-segment-mirroring.html">启用Segment镜像</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/highavail/topics/g-enabling-master-mirroring.html">启用Master镜像</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/highavail/topics/g-detecting-a-failed-segment.html">检测故障的Segment</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/highavail/topics/g-checking-for-failed-segments.html">检测故障Segment</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/highavail/topics/g-checking-the-log-files.html">检查日志文件</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/highavail/topics/g-recovering-a-failed-segment.html">恢复故障Segment</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/highavail/topics/g-recovering-from-segment-failures.html">从Segment故障中恢复</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/highavail/topics/g-when-a-segment-host-is-not-recoverable.html">当一台Segment主机不可恢复时</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/highavail/topics/g-recovering-a-failed-master.html">恢复故障的Master</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/highavail/topics/g-restoring-master-mirroring-after-a-recovery.html">在恢复后还原Master镜像</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/managing/backup-main.html">备份和恢复数据库</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/backup-overview.html">备份和恢复概述</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/managing/backup-gpbackup.html">使用gpbackup和gprestore并行备份</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/backup-gpbackup.html#topic_vh5_1hd_tbb">需求和限制</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/backup-gpbackup.html#topic_x3s_lqj_tbb">备份或还原中包含的对象</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/backup-gpbackup.html#topic_qgj_b3d_tbb">执行基本备份和还原操作</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/backup-gpbackup.html#topic_et4_b5d_tbb">过滤备份或恢复的内容</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/backup-gpbackup.html#topic_qwd_d5d_tbb">配置邮件通知</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/backup-gpbackup.html#topic_xnj_b4c_tbb">理解备份文件</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/managing/backup-gpbackup-incremental.html">使用gpbackup和gprestore创建增量备份</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/backup-gpbackup-incremental.html#topic_kvf_mkr_t2b">关于增量备份集</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/backup-gpbackup-incremental.html#topic_btr_xfr_t2b">使用增量备份</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/managing/backup-boostfs.html">将gpbackup和gprestore与BoostFS一起使用</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/backup-boostfs.html#topic_zp4_mvv_bdb">安装BoostFS</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/backup-boostfs.html#topic_t4z_tvv_bdb">使用BoostFS备份和恢复</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/managing/backup-plugins.html">使用gpbackup存储插件</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/backup-s3-plugin.html">使用带有gpbackup和gprestore的S3存储插件</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/managing/backup-plugin-api.html">备份&#x2F;恢复存储插件API（Beta版）</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/plugin_api/backup_data.html">backup_data</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/plugin_api/backup_file.html">backup_file</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/plugin_api/cleanup_plugin_for_backup.html">cleanup_plugin_for_backup</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/plugin_api/cleanup_plugin_for_restore.html">cleanup_plugin_for_restore</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/plugin_api/plugin_api_version.html">plugin_api_version</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/plugin_api/restore_data.html">restore_data</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/plugin_api/restore_file.html">restore_file</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/plugin_api/setup_plugin_for_backup.html">setup_plugin_for_backup</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/plugin_api/setup_plugin_for_restore.html">setup_plugin_for_restore</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/expand/expand-main.html">扩容Greenplum系统</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/expand/expand-overview.html">系统扩容概述</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/expand/expand-planning.html">规划Greenplum系统扩容</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/expand/expand-nodes.html">准备并增加节点</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/expand/expand-initialize.html">初始化新节点</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/expand/expand-redistribute.html">重分布表</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/expand/expand-rm-schema.html">移除扩容Schema</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/monitor.html">监控Greenplum系统</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/managing/maintain.html">日常系统维护任务</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/monitoring/monitoring.html">Recommended Monitoring and Maintenance Tasks</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/partIII.html">管理Greenplum数据库访问</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/client_auth.html">配置客户端认证</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/ldap.html">使用带TLS&#x2F;SSL的LDAP认证</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/kerberos.html">使用Kerberos认证</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/kerberos-lin-client.html">为Linux客户端进行Kerberos配置</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/kerberos-win-client.html">为Windows客户端进行Kerberos配置</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/roles_privs.html">管理角色与权限</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/ddl/ddl.html">定义数据库对象</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/ddl/ddl-database.html">创建和管理数据库</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/ddl/ddl-tablespace.html">创建和管理表空间</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/ddl/ddl-schema.html">创建和管理SCHEMA</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/ddl/ddl-table.html">创建和管理表</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/ddl/ddl-storage.html">选择表存储模型</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/ddl/ddl-partition.html">对大型表分区</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/ddl/ddl-sequence.html">创建和使用序列</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/ddl/ddl-index.html">在Greenplum数据库中使用索引</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/ddl/ddl-view.html">创建和管理视图</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/distribution.html">分布与倾斜</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/dml.html">插入, 更新, 和删除数据 </a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/query/topics/query.html">查询数据</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/parallel-proc.html">关于Greenplum的查询处理</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/query/topics/query-piv-optimizer.html">关于GPORCA</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/query-piv-opt-overview.html">GPORCA概述</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/query-piv-opt-enable.html">启用和禁用GPORCA</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/query-piv-opt-root-partition.html">收集根分区统计信息</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/query-piv-opt-notes.html">使用GPORCA时的考虑</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/query-piv-opt-features.html">GPORCA特性和增强</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/query-piv-opt-changed.html">GPORCA改变的行为</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/query-piv-opt-limitations.html">GPORCA的限制</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/query-piv-opt-fallback.html">判断被使用的查询优化器</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/query-piv-uniform-part-tbl.html">关于统一多级分区表</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/defining-queries.html">定义查询</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/CTE-query.html">WITH查询（公用表表达式）</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/functions-operators.html">使用函数和操作符</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/json-data.html">使用JSON数据</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/xml-data.html">使用XML数据</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/textsearch/full-text-search.html">使用全文搜索</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/textsearch/intro.html">关于全文搜索</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/textsearch/tables-indexes.html">在数据库表中搜索文本</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/textsearch/controlling.html">控制文本搜索</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/textsearch/features.html">文本搜索附加功能</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/textsearch/parsers.html">文本搜索解析器</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/textsearch/dictionaries.html">文本搜索词典</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/textsearch/configuration.html">文本搜索配置示例</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/textsearch/testing.html">测试和调试文本搜索</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/textsearch/gist-gin.html">文本搜索的GiST和GIN索引</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/textsearch/psql-support.html">psql支持</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/textsearch/limitations.html">限制</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/query-performance.html">查询性能</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/spill-files.html">管理查询生成的溢出文件</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/query/topics/query-profiling.html">查询分析</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/external/g-working-with-file-based-ext-tables.html">使用外部数据</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/external/g-external-tables.html">定义外部表</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-file-protocol.html">file:&#x2F;&#x2F;协议</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-gpfdist-protocol.html">gpfdist:&#x2F;&#x2F;协议</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-gpfdists-protocol.html">gpfdists:&#x2F;&#x2F; 协议</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-pxf-protocol.html">pxf:&#x2F;&#x2F; 协议</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-s3-protocol.html">s3:&#x2F;&#x2F; 协议</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-accessing-ext-files-custom-protocol.html">使用自定义协议</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-handling-errors-ext-table-data.html">处理外部表数据中的错误</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-creating-and-using-web-external-tables.html">创建和使用外部Web表</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/external/g-creating-external-tables---examples.html">Examples for Creating External Tables</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-example-1-single-gpfdist-instance-on-single-nic-machine.html">Example 1—Single gpfdist instance on single-NIC machine</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-example-2-multiple-gpfdist-instances.html">Example 2—Multiple gpfdist instances </a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-example-3-multiple-gpfdists-instances.html">Example 3—Multiple gpfdists instances </a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-example-4-single-gpfdist-instance-with-error-logging.html">Example 4—Single gpfdist instance with error logging</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-example-5-text-format-on-a-hadoop-distributed-file-server.html">Example 5—TEXT Format on a Hadoop Distributed File Server</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-example-6-multiple-files-in-csv-format-with-header-rows.html">Example 6—Multiple files in CSV format with header rows</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-example-7-readable-web-external-table-with-script.html">Example 7—Readable External Web Table with Script</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-example-8-writable-external-table-with-gpfdist.html">Example 8—Writable External Table with gpfdist</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-example-9-writable-external-web-table-with-script.html">Example 9—Writable External Web Table with Script</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-example-10-readable-and-writable-external-tables-with-xml-transformations.html">Example 10—Readable and Writable External Tables with XML Transformations</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/pxf-overview.html">使用PXF访问外部数据</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/external/g-foreign.html">使用外部表访问外部数据</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-devel-fdw.html">写一个外部数据的包装器</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/g-using-the-greenplum-parallel-file-server--gpfdist-.html">使用Greenplum的并行文件服务器（gpfdist）</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/load/topics/g-loading-and-unloading-data.html">装载和卸载数据</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-loading-data-using-an-external-table.html">使用外部表装载数据</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/load/topics/g-loading-and-writing-non-hdfs-custom-data.html">装载和写入非HDFS自定义数据</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/load/topics/g-using-a-custom-format.html">使用一种自定义格式</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-importing-and-exporting-fixed-width-data.html">导入和导出固定宽度的数据</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-examples-read-fixed-width-data.html">例子：读取宽度固定的数据</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-using-a-custom-protocol.html">使用一种自定协议</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/load/topics/g-handling-load-errors.html">处理装载错误</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-define-an-external-table-with-single-row-error-isolation.html">定义一个带有单行错误隔离的外部表</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-create-an-error-table-and-declare-a-reject-limit.html">捕捉行格式化错误并且声明拒绝极限 </a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-viewing-bad-rows-in-the-error-table-or-error-log.html">在错误日志中查看不正确的行</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-moving-data-between-tables.html">在表之间移动数据</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-loading-data-with-gpload.html">用gpload装载数据</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/external/pxf-overview.html">使用PXF访问外部数据</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/transforming-xml-data.html">使用gpfdist和gpload转换外部数据</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-loading-data-with-copy.html">用COPY装载数据</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-running-copy-in-single-row-error-isolation-mode.html">在单行错误隔离模式中运行COPY</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-optimizing-data-load-and-query-performance.html">优化数据装载和查询性能</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/load/topics/g-unloading-data-from-greenplum-database.html">从Greenplum数据库卸载数据</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/load/topics/g-defining-a-file-based-writable-external-table.html">定义基于文件的可写外部表</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-example-1-greenplum-file-server-gpfdist.html">例 1—Greenplum文件服务器（gpfdist）</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-example-2-hadoop-file-server.html">例 2—Hadoop文件系统(pxf)</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/load/topics/g-defining-a-command-based-writable-external-web-table.html">定义基于命令的可写外部Web表</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-disabling-execute-for-web-or-writable-external-tables.html">为Web或者可写外部表禁用EXECUTE</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-unloading-data-using-a-writable-external-table.html">使用可写外部表卸载数据</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-unloading-data-using-copy.html">使用COPY卸载数据</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/load/topics/g-formatting-data-files.html">格式化数据文件</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-formatting-rows.html">格式化行</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-formatting-columns.html">格式化列</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-representing-null-values.html">表示NULL值</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/load/topics/g-escaping.html">转义</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-escaping-in-text-formatted-files.html">在文本格式的文件中转义</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-escaping-in-csv-formatted-files.html">在CSV格式的文件中转义</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-character-encoding.html">字符编码</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/load/topics/g-example-custom-data-access-protocol.html">自定义数据访问协议实例 </a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/load/topics/g-installing-the-external-table-protocol.html">安装外部表协议</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/load/topics/g-gpextprotocal.c.html">gpextprotocal.c</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/partV.html">性能管理</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/perf_intro.html">管理性能</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/perf_issues.html">性能问题的常见原因</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/wlmgmt_intro.html">Greenplum数据库内存总览</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/6-0/admin_guide/wlmgmt.html">管理资源</a>
        
  <ul>
    
      <li class="">
        <a href="/6-0/admin_guide/workload_mgmt_resgroups.html">用资源组进行工作负载管理</a>
        

      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/workload_mgmt.html">使用资源队列</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/6-0/admin_guide/perf_troubleshoot.html">检修性能问题</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
  </ul>


  </div>
</div>

      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        
          <h1 class="title-container" style="display: none;">
    日常系统维护任务
  </h1>

          <div id="js-quick-links" >
            
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        

  <h1 class="title topictitle1">日常系统维护任务</h1>

  
  <div class="body">
<p class="shortdesc">要保持一个Greenplum数据库系统高效运行，必须对数据库定期清理过期数据并且更新表统计信息，
    这样查询优化器才能有准确的信息。</p>

    <p class="p">Greenplum数据库要求定期执行特定的任务来达到最优性能。这里讨论的任务都是必须的，但数据库管理员可以使用
      标准的UNIX工具（如<samp class="ph codeph">cron</samp>脚本）来自动化这些任务。管理员建立适当的脚本并且检查它们是否
      成功执行。关于用来保持Greenplum系统最优化运行的额外建议维护活动，请见<a class="xref" href="../monitoring/monitoring.html#topic_kmz_lbg_rp" title="This section lists monitoring and maintenance activities recommended to ensure high availability and consistent performance of your Greenplum Database cluster.">Recommended Monitoring and Maintenance Tasks</a>。</p>

  </div>

  <div class="related-links">
<div class="familylinks">
<div class="parentlink">
<strong>Parent topic:</strong> <a class="link" href="../managing/partII.html" title="这一节描述了一个Greenplum数据库系统管理员所执行的基本系统管理任务。">管理一个Greenplum系统</a>
</div>
</div>
</div>
<div class="topic nested1" xml:lang="en" lang="en" id="topic2">
    <h2 class="title topictitle2">例行清理和分析</h2>

    <div class="body">
      <p class="p">Greenplum数据库中使用的MVCC事务并发模型的设计意味着被删除或者被更新的数据行仍在磁盘上占据物理空间，
        即便它们已经对新事务不可见。如果数据库进行了很多更新和删除，会有很多过期行存在并且它们所使用的空间必须使用
        <samp class="ph codeph">VACUUM</samp>命令来回收。<samp class="ph codeph">VACUUM</samp>命令还会收集表级的统计信息，例如行数和
        页面数，因此即便无需从被更新或者被删除行回收空间，也还是有必要去清理追加优化表。</p>

      <p class="p">清理一个追加优化表遵循一种和清理堆表不同的处理逻辑。在每一个Segment上，会创建一个新的Segment文件并且
        把可见行从当前Segment复制到该文件中。当Segment文件被拷贝完时，将会安排删除原始的Segment文件并且让新
        的Segment文件变得可用。这要求足够的可用磁盘空间用于拷贝可见行，直到原始的Segment文件被删除为止。</p>

      <p class="p">如果一个Segment文件中隐藏行和所有行的比率低于一个阈值（默认是10），该Segment文件不会被紧缩。
        该阈值可以通过<samp class="ph codeph">gp_appendonly_compaction_threshold</samp>服务器配置参数配置。<samp class="ph codeph">VACUUM FULL</samp>
        忽略<samp class="ph codeph">gp_appendonly_compaction_threshold</samp>的值并且不管该比率为多少都会重写Segment文件。</p>

      <p class="p">可以使用<em class="ph i">gp_toolkit</em>模式中的<samp class="ph codeph">__gp_aovisimap_compaction_info()</samp>函数来查看
        追加优化表上的<span class="keyword cmdname">VACUUM</span>操作的效果。</p>

      <p class="p">有关<samp class="ph codeph">__gp_aovisimap_compaction_info()</samp>函数的信息请见<cite class="cite">Greenplum Database Reference Guide</cite>
        “检查追加优化表”部分</p>

      <p class="p">可以使用<samp class="ph codeph">gp_appendonly_compaction</samp>服务器配置参数为追加优化表禁用
        <samp class="ph codeph">VACUUM</samp>操作。</p>

      <p class="p">有关清理数据库的细节请见<a class="xref" href="../dml.html#topic9">清理数据库</a>。</p>

      <p class="p">有关<samp class="ph codeph">gp_appendonly_compaction_threshold</samp>服务器配置参数和<samp class="ph codeph">VACUUM</samp>
        命令的信息请见<cite class="cite">Greenplum Database Reference Guide</cite>。</p>

    </div>

    <div class="topic nested2" xml:lang="en" lang="en" id="topic3">
      <h3 class="title topictitle3">事务ID管理</h3>

      <div class="body">
        <p class="p">Greenplum的MVCC事务机制依赖于比较事务ID（XID）号来判断当前数据对于其他事务的可见性。
          事务ID号使用一种模2<sup class="ph sup">32</sup>的算法来比较，因此一个运行了超过二十亿事务的
          Greenplum系统可能会遇到事务ID回卷，即过去的事务变成了未来的事务。这意味着过去的事务的
          输出变得不可见。因此，每过二十亿个事务就有必要<samp class="ph codeph">VACUUM</samp>每个数据库中的
          每个表至少一次。</p>

        <p class="p">Greenplum数据库只对涉及DDL或者DML操作的事务分配XID值，通常也只有这些事务需要XID。</p>

        <div class="note important">
<span class="importanttitle">Important:</span> Greenplum数据库会监控事务ID。如果没有定期清理数据库，Greenplum
          数据库将产生警告和错误。</div>

        <p class="p">当事务ID中相当多的一部分变得不再可用并且事务ID回卷还没有发生时，Greenplum数据库会发出
          下面的警告：</p>

        <p class="p">
          <samp class="ph codeph">WARNING: database "database_name" must be vacuumed within
              <em class="ph i">number_of_transactions</em> transactions</samp>
        </p>

        <p class="p">当这个警告被发出时，需要一次<samp class="ph codeph">VACUUM</samp>操作。如果没有执行<samp class="ph codeph">VACUUM</samp>
          操作，当Greenplum数据库在事务ID回卷发生前达到一个限制，它会停止创建新的事务。在停止创建
          事务以避免可能的数据丢失时，Greenplum数据库会发出这个错误：</p>

        <div class="p">
          <pre class="pre codeblock">FATAL: database is not accepting commands to avoid 
wraparound data loss in database "database_name"
</pre>

        </div>

        <p class="p">Greenplum数据库配置参数<samp class="ph codeph">xid_warn_limit</samp>控制何时显示该警告。参数
          <samp class="ph codeph">xid_stop_limit</samp>控制何时Greenplum数据库停止创建事务。</p>

        <div class="section" id="topic3__np160654">
<h4 class="title sectiontitle">从一次事务ID限制错误中恢复</h4>
          
          <p class="p">当Greenplum数据库由于不频繁的<samp class="ph codeph">VACUUM</samp>维护而达到
            <samp class="ph codeph">xid_stop_limit</samp>事务ID限制时，它会变得没有响应。为了从这种情况中
            恢复过来，作为数据库管理员执行下面的步骤：</p>

          <ol class="ol">
            <li class="li" id="topic3__np160540">关闭Greenplum数据库。</li>

            <li class="li" id="topic3__np160541">临时将<samp class="ph codeph">xid_stop_limit</samp>降低10,000,000。</li>

            <li class="li" id="topic3__np160542">启动Greenplum数据库。</li>

            <li class="li" id="topic3__np160543">在所有受影响的数据库上运行<samp class="ph codeph">VACUUM FREEZE</samp>。</li>

            <li class="li" id="topic3__np160517">将<samp class="ph codeph">xid_stop_limit</samp>重置为原来的值。</li>

            <li class="li" id="topic3__np160622">重启Greenplum数据库。</li>

          </ol>

          <p class="p">有关这些配置参数的信息请见<em class="ph i">Greenplum Database Reference Guide</em>。</p>

          <p class="p">有关事务ID回卷的信息请见<a class="xref" href="https://www.postgresql.org/docs/9.4/index.html" target="_blank"><span class="ph">PostgreSQL documentation</span></a>.</p>

        </div>

      </div>

    </div>

    <div class="topic nested2" xml:lang="en" lang="en" id="topic4">
      <h3 class="title topictitle3">系统目录维护</h3>

      <div class="body">
        <p class="p">多次使用<samp class="ph codeph">CREATE</samp>和<samp class="ph codeph">DROP</samp>命令的数据库更新会增长系统目录尺寸并且
          影响系统性能。例如，运行很多次<samp class="ph codeph">DROP TABLE</samp>语句会降低总体系统性能，因为在目录表上
          的元数据查询期间会需要更多扫描时间。性能损失会在数千次或者数万次<samp class="ph codeph">DROP TABLE</samp>语句
          之间发生，具体时间取决于系统。</p>

        <p class="p">应该定期维护系统目录来回收已删除对象所占据的空间。如果长时间没有运行这种定期回收操作，那可能需要运行
          一个更彻底的回收操作来清理系统目录。这个主题会描述这两种方式。</p>

      </div>

      <div class="topic nested3" xml:lang="en" lang="en" id="topic5">
        <h4 class="title topictitle4">常规系统目录维护</h4>

        <div class="body">
          <p class="p">推荐周期性地在系统目录上运行<samp class="ph codeph">REINDEX</samp>和<samp class="ph codeph">VACUUM</samp>来清理系统索引和
            表中已删除对象所占用的空间。如果常规的数据库操作包括很多<samp class="ph codeph">DROP</samp>语句，那么每天在非峰值
            时间用<samp class="ph codeph">VACUUM</samp>命令运行一次系统目录维护是安全且适当的。用户可以在系统可用时执行这种操作。</p>

          <div class="p">下面是Greenplum数据库系统目录维护步骤。<ol class="ol" id="topic5__ol_un5_p1l_f2b">
            <li class="li">在系统表上执行<samp class="ph codeph">REINDEX</samp>命令以重建系统表索引。该操作移除索引膨胀并提高<samp class="ph codeph">VACUUM</samp>
              性能。
                <div class="note note">
<span class="notetitle">Note:</span> 当在系统表上执行<samp class="ph codeph">REINDEX</samp>操作时，表上会产生锁，此时可能会对当前正在运行的
                  查询产生比较大的影响。建议在系统负载较低时执行<samp class="ph codeph">REINDEX</samp>操作，以避免对正在运行的
                  业务操作产生较大的干扰。</div>
</li>

              <li class="li">在系统表上执行<samp class="ph codeph">VACUUM</samp>操作。</li>

              <li class="li">在系统表上执行<samp class="ph codeph">ANALYZE</samp>操作，用以更新统计信息。</li>

            </ol>
</div>

          <p class="p">下面的示例脚本在一个Greenplum数据库系统目录上执行一次<samp class="ph codeph">REINDEX</samp>、<samp class="ph codeph">VACUUM</samp>
            以及<samp class="ph codeph">ANALYZE</samp>操作：
            将脚本中的<samp class="ph codeph">&lt;<var class="keyword varname">database-name</var>&gt;</samp>替换为真实数据库名。</p>

          <pre class="pre codeblock">#!/bin/bash
DBNAME="&lt;<var class="keyword varname">database-name</var>&gt;"
SYSTABLES="' pg_catalog.' || relname || ';' FROM pg_class a, pg_namespace b 
WHERE a.relnamespace=b.oid AND b.nspname='pg_catalog' AND a.relkind='r'"

reindexdb --system -d $DBNAME
psql -tc "SELECT 'VACUUM' || $SYSTABLES" $DBNAME | psql -a $DBNAME
analyzedb -s pg_catalog -d $DBNAME
</pre>

          <div class="note note">
<span class="notetitle">Note:</span> 如果在系统维护时间内已经开始了正常的系统目录维护操作，但是由于时间原因想要停止某一维护进程，
            此时可以运行Greenplum数据库函数<samp class="ph codeph">pg_cancel_backend(&lt;<var class="keyword varname">PID</var>&gt;)</samp>
            以安全停止该Greenplum数据库进程。</div>

        </div>

      </div>

      <div class="topic nested3" xml:lang="en" lang="en" id="topic6">
        <h4 class="title topictitle4">深度系统目录维护</h4>

        <div class="body">
          <p class="p">如果很长时间都没有执行一次系统目录维护操作，该目录可能因为废弃空间而膨胀。这会导致简单的元数据
            操作都会等待很长时间。在<samp class="ph codeph">psql</samp>中用<samp class="ph codeph">\d</samp>命令列出用户表需要超过
            两秒的等待，就是目录膨胀的一种征兆。</p>

          <p class="p">如果发现系统目录膨胀的征兆，就必须在计划好的停机时段用<samp class="ph codeph">VACUUM FULL</samp>执行一次
            深度系统目录维护操作。在这一时段中，停止系统上的所有目录活动，这种<samp class="ph codeph">VACUUM FULL</samp>
            系统目录维护过程会对系统目录加排他锁。</p>

          <p class="p">运行定期系统目录维护操作可以防止对这种更高开销操作的需求。</p>

          <div class="p">以下是深度系统目录维护操作的步骤。<ol class="ol" id="topic6__ol_trp_xqs_f2b">
              <li class="li">停止Greenplum数据库系统上的所有活动元数据操作。</li>

              <li class="li">在系统表上执行<samp class="ph codeph">REINDEX</samp>操作以重建系统表索引。该操作移除索引上的膨胀并提高
                  <samp class="ph codeph">VACUUM</samp>操作性能。</li>

              <li class="li">在系统表上执行<samp class="ph codeph">VACUUM FULL</samp>命令，具体查看下面的注释。</li>

              <li class="li">在系统表上执行<samp class="ph codeph">ANALYZE</samp>命令以更新系统表的统计信息。</li>

            </ol>
</div>

          <div class="note note">
<span class="notetitle">Note:</span> 通常来说，表<samp class="ph codeph">pg_attribute</samp>是最大的系统表。如果<samp class="ph codeph">pg_attribute</samp>
            表膨胀的特别厉害，该表上的<samp class="ph codeph">VACUUM FULL</samp>操作可能需要更长的时间并且可能需要分开执行。
            以下两种情况的出现预示着<samp class="ph codeph">pg_attribute</samp>表膨胀很厉害并且需要长时间的<samp class="ph codeph">VACUUM FULL</samp>
            操作：<ul class="ul" id="topic6__ul_fl3_dty_f2b">
              <li class="li">
<samp class="ph codeph">pg_attribute</samp>表包含大量记录。</li>

              <li class="li">
<samp class="ph codeph">gp_toolkit.gp_bloat_diag</samp>视图中的信息显示<samp class="ph codeph">pg_attribute</samp>的状态为<samp class="ph codeph">significant
                  amount of bloat</samp>
</li>

            </ul>
</div>

        </div>

      </div>

    </div>

    <div class="topic nested2" xml:lang="en" lang="en" id="topic7">
      <h3 class="title topictitle3">为查询优化进行清理和分析</h3>

      <div class="body">
        <p class="p">Greenplum数据库使用一种基于代价的查询优化器，它依赖于数据库的统计信息。准确的统计信息帮助查询优化器
          更好的评估选择度以及一个查询操作检索的行数。这些评估会帮助它选择最有效的查询计划。<samp class="ph codeph">ANALYZE</samp>
          命令会为查询优化器收集列级的统计信息。</p>

        <p class="p">可以在同一个命令中同时执行<samp class="ph codeph">VACUUM</samp>和<samp class="ph codeph">ANALYZE</samp>操作。例如：</p>

        <div class="p">
          <pre class="pre codeblock">=# VACUUM ANALYZE mytable;
</pre>

        </div>

        <p class="p">当在一个显著膨胀的表（显著膨胀的表磁盘空间被已删除或者已废弃行占据）上运行<span class="keyword cmdname">VACUUM ANALYZE</span>
          命令时，该命令可能会产生不正确的统计信息。对于大型的表，<samp class="ph codeph">ANALYZE</samp>命令会从行的一个随机
          采样中计算统计信息。它会通过计算采样中每页的平均行数与表中实际页数的成绩来估算表中的总行数。如果采样包含
          很多空页，估计出的行计数可能会不准确。
          </p>

        <p class="p">对于一个表，可以在<em class="ph i">gp_toolkit</em>视图<em class="ph i">gp_bloat_diag</em>中查看有关未使用磁盘空间（被已删除或者
          已废弃行占据的空间）量的信息。如果一个表的<samp class="ph codeph">bdidiag</samp>列包含值
          <samp class="ph codeph">significant amount of bloat suspected</samp>，那么相当多的表磁盘空间由未使用空间组成。
          在一个表被清理后，相关项会被加入到<em class="ph i">gp_bloat_diag</em>视图中。</p>

        <p class="p">要从表中移除未使用的磁盘空间，可以在该表上运行命令<span class="keyword cmdname">VACUUM FULL</span>。由于对表锁的需求，
          <span class="keyword cmdname">VACUUM FULL</span>可能无法在非维护时段运行。
        </p>

        <div class="p">作为一种临时的变通方案，可以运行<span class="keyword cmdname">ANALYZE</span>来计算列统计信息，然后在该表上运行
          <span class="keyword cmdname">VACUUM</span>来生成准确的行计数。这个例子在<em class="ph i">cust_info</em>表上先运行<span class="keyword cmdname">ANALYZE</span>，
          然后运行<span class="keyword cmdname">VACUUM</span>。
         <pre class="pre codeblock">ANALYZE cust_info;
VACUUM cust_info;</pre>
</div>

        <div class="note important">
<span class="importanttitle">Important:</span> 如果想要在启用了GPORCA（默认启用）的情况下对分区表执行查询，
          必须用<span class="keyword cmdname">ANALYZE</span>命令在分区表根分区上收集统计信息。有关GPORCA的信息，请见<a class="xref" href="../query/topics/query-piv-opt-overview.html" title="GPORCA扩展了Greenplum数据库传统优化器的规划和优化能力。">GPORCA概述</a>。</div>

        <div class="note note">
<span class="notetitle">Note:</span> 可以使用Greenplum数据库工具<span class="keyword cmdname">analyzedb</span>来更新表统计信息。表可以被并行地分析。
          对于追加优化表，只有统计信息不是当前值时，<span class="keyword cmdname">analyzedb</span>才会更新统计信息。有关analyzedb
          工具的信息，请见<samp class="ph codeph"><a class="xref" href="../../utility_guide/admin_utilities/analyzedb.html">analyzedb</a></samp>。</div>

      </div>

    </div>

  </div>

  <div class="topic nested1" xml:lang="en" lang="en" id="topic8">
    <h2 class="title topictitle2">常规的索引重建</h2>

    <div class="body">
      <p class="p">对于B-树索引，一个刚刚构建的索引访问起来比一个已经更新过很多次的索引要快一点，因为在新构建的索引中逻辑
        上相邻的页面在物理上也相邻。定期地重建旧的索引可以提升访问速度。如果一个页面上除了索引以外的数据都被删除，
        那么索引页上对应的也会产生浪费的空间。重建索引操作会回收这些被浪费的空间。在Greenplum数据库中，删除索引
        (<samp class="ph codeph">DROP INDEX</samp>)再重建 (<samp class="ph codeph">CREATE INDEX</samp>)通常比直接使用<samp class="ph codeph">REINDEX</samp>
        命令要快。</p>

      <p class="p">对于有索引的表列，批量更新或者插入之类的一些操作可能会执行得更慢，因为需要更新索引。为了提高带有索引
        的表上的批量操作性能，可以先删除掉索引，然后执行批量操作，最后再重建索引。</p>

    </div>

  </div>

  <div class="topic nested1" xml:lang="en" lang="en" id="topic9">
    <h2 class="title topictitle2">管理Greenplum数据库日志文件</h2>

    <div class="body">
      <ul class="ul">
        <li class="li" id="topic9__np159000">
          <a class="xref" href="#topic10">数据库服务器日志文件</a>
        </li>

        <li class="li" id="topic9__np159008">
          <a class="xref" href="#topic11">管理工具日志文件</a>
        </li>

      </ul>

    </div>

    <div class="topic nested2" xml:lang="en" lang="en" id="topic10">
      <h3 class="title topictitle3">数据库服务器日志文件</h3>

      <div class="body">
        <p class="p">Greenplum数据库的日志输出常常会体量很大，尤其是在调试级别时，用户不需要无限期保存它。管理员可以应该
          定期清理日志文件。</p>

        <p class="p">Greenplum数据库在Master和所有的Segment实例上都启用了日志文件轮转。
          日志文件被创建在Master以及每个Segment的数据目录中的<samp class="ph codeph">pg_log</samp>子目录下，这些文件使用
          命名规则：<samp class="ph codeph">gpdb-<em class="ph i">YYYY</em>-<em class="ph i">MM</em>-<em class="ph i">DD_hhmmss</em>.csv</samp>。数据库管理员需要
          编写脚本或程序定期清理Master以及每个Segment日志目录<samp class="ph codeph">pg_log</samp>下的旧文件。</p>

        <p class="p">日志轮转可以被当前日志文件的大小或当前日志文件的年龄触发。<samp class="ph codeph">log_rotation_size</samp>
          配置参数设置触发日志轮转的单个日志文件大小。当日志文件大小等于或大于特定的大小时，该文件会停止写入，
          系统重新创建一个新的日志文件。<samp class="ph codeph">log_rotation_size</samp>的值的单位为KB。默认为1048576，
          即1GB。如果<samp class="ph codeph">log_rotation_size</samp>设置为0，表示基于文件大小的日志轮转被禁用。
          </p>

        <p class="p"><samp class="ph codeph">log_rotation_age</samp>配置参数定义了出发日志轮转的日志文件年龄。当文件自创建时开始到达
          特定长度的时间时，该文件停止写入，系统重新创建一个新的日志文件。默认的<samp class="ph codeph">log_rotation_age</samp>
          时间为1d，即当前日志文件创建24小时之后。如果<samp class="ph codeph">log_rotation_age</samp>设置为0，表示基于时间
          的轮转被禁用。</p>

        <p class="p">更多查看数据库日志文件的信息，请见<a class="xref" href="monitor.html#topic28">查看数据库服务器日志文件</a>.</p>

      </div>

    </div>

    <div class="topic nested2" xml:lang="en" lang="en" id="topic11">
      <h3 class="title topictitle3">管理工具日志文件</h3>

      <div class="body">
        <p class="p">reenplum数据库管理工具的日志文件默认被写入到<samp class="ph codeph">~/gpAdminLogs</samp>。管理日志文件的命名规则是：
            </p>

        <pre class="pre codeblock"><var class="keyword varname">script_name</var>_<var class="keyword varname">date</var>.log
</pre>

        <p class="p">日志详情的格式是：</p>

        <pre class="pre codeblock"><var class="keyword varname">timestamp</var>:<var class="keyword varname">utility</var>:<var class="keyword varname">host</var>:<var class="keyword varname">user</var>:[INFO|WARN|FATAL]:<var class="keyword varname">message</var>
</pre>

        <p class="p">每次一个工具运行时，就会向其每日的日志文件中增加与其执行相关的日志信息。</p>

      </div>

    </div>

  </div>



        

      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    
  </footer>
</div><!--end of container-->

</body>
</html>
