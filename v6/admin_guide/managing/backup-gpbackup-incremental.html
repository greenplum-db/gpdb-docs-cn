<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      使用gpbackup和gprestore创建增量备份 |
    Greenplum Database Docs
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/gpdb-docs-cn/stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="/gpdb-docs-cn/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='/gpdb-docs-cn/images/favicon.ico' rel='shortcut icon'>

  <script src="/gpdb-docs-cn/javascripts/all.js"></script>
  
</head>

<body class="x6-0 x6-0_admin_guide x6-0_admin_guide_managing x6-0_admin_guide_managing_backup-gpbackup-incremental has-subnav">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">
      document.domain = "greenplum.org";
    </script>

     
  <header class="header header-layout">
    <h1 class="logo">
      <a href="/">Greenplum Database Documentation</a>
    </h1>
    
    <div class="header-links js-bar-links">
      <div class="btn-menu" data-behavior="MenuMobile"></div>
      <div class="header-item"><a href="https://greenplum.org">Back to Greenplum Database</a></div>
      <div class="header-item">
        <a href="https://github.com/greenplum-db/gpdb/wiki">Wiki</a>
      </div>
      
    </div>
  </header>


    <div class="container">

      <!--googleoff: index-->
      <div id="sub-nav" class="nav-container js-sidenav" role="navigation" >
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/../../gpdb-docs-cn/v6/homenav.html">Greenplum数据库® 6.0文档</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/admin_guide.html">管理员指南</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/intro/partI.html">Greenplum数据库概念</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/intro/arch_overview.html">关于Greenplum的架构</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/intro/about_utilities.html">关于管理和监控工具</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/intro/about_mvcc.html">关于Greenplum数据库中的并发控制</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/intro/mvcc_example.html">管理事务ID的例子</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/intro/about_loading.html">关于并行数据装载</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/intro/about_ha.html">关于Greenplum数据库中的冗余和故障切换</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/intro/about_statistics.html">关于Greenplum数据库中的数据库统计信息</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/partII.html">管理一个Greenplum系统</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/versioning.html">关于Greenplum数据库发布版本号</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/startstop.html">启动和停止Greenplum数据库</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/access_db/topics/g-accessing-the-database.html">访问数据库</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/access_db/topics/g-establishing-a-database-session.html">建立一个数据库会话</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/access_db/topics/g-supported-client-applications.html">支持的客户端应用</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/access_db/topics/g-greenplum-database-client-applications.html">Greenplum数据库客户端应用</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/access_db/topics/g-connecting-with-psql.html">用psql连接</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/access_db/topics/pgbouncer.html">使用PgBouncer连接池</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/access_db/topics/g-database-application-interfaces.html">数据库应用接口</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/access_db/topics/g-troubleshooting-connection-problems.html">连接问题的发现及解决</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/topics/g-configuring-the-greenplum-system.html">配置Greenplum数据库系统</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/topics/g-about-greenplum-master-and-local-parameters.html">关于Greenplum数据库的Master参数和本地参数</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/topics/g-setting-configuration-parameters.html">设置配置参数</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/topics/g-setting-a-local-configuration-parameter.html">设置本地配置参数</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/topics/g-setting-a-master-configuration-parameter.html">设置Master配置参数</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/topics/g-setting-parameters-at-the-system-level.html">设置系统级别参数</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/topics/g-setting-parameters-at-the-database-level.html">设置数据库级别参数</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/topics/g-setting-parameters-at-the-role-level.html">设置角色级别参数</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/topics/g-setting-parameters-in-a-session.html">设置会话级别参数</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/topics/g-viewing-server-configuration-parameter-settings.html">查看服务器配置参数设置</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/topics/g-configuration-parameter-categories.html">配置参数种类</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/compression.html">启用压缩</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/highavail/topics/g-enabling-high-availability-features.html">启用高可用和数据持久化特征</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/highavail/topics/g-overview-of-high-availability-in-greenplum-database.html">Greenplum数据库高可用性概述</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/highavail/topics/g-overview-of-segment-mirroring.html">Segment镜像概述</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/highavail/topics/g-overview-of-master-mirroring.html">Master镜像概述</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/highavail/topics/g-enabling-mirroring-in-greenplum-database.html">在Greenplum数据库中启用镜像</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/highavail/topics/g-enabling-segment-mirroring.html">启用Segment镜像</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/highavail/topics/g-enabling-master-mirroring.html">启用Master镜像</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/highavail/topics/g-detecting-a-failed-segment.html">检测故障的Segment</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/highavail/topics/g-checking-for-failed-segments.html">检测故障Segment</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/highavail/topics/g-checking-the-log-files.html">检查日志文件</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/highavail/topics/g-recovering-a-failed-segment.html">恢复故障Segment</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/highavail/topics/g-recovering-from-segment-failures.html">从Segment故障中恢复</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/highavail/topics/g-when-a-segment-host-is-not-recoverable.html">当一台Segment主机不可恢复时</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/highavail/topics/g-recovering-a-failed-master.html">恢复故障的Master</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/highavail/topics/g-restoring-master-mirroring-after-a-recovery.html">在恢复后还原Master镜像</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-main.html">备份和恢复数据库</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-overview.html">备份和恢复概述</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-gpbackup.html">使用gpbackup和gprestore并行备份</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-gpbackup.html#topic_vh5_1hd_tbb">需求和限制</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-gpbackup.html#topic_x3s_lqj_tbb">备份或还原中包含的对象</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-gpbackup.html#topic_qgj_b3d_tbb">执行基本备份和还原操作</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-gpbackup.html#topic_et4_b5d_tbb">过滤备份或恢复的内容</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-gpbackup.html#topic_qwd_d5d_tbb">配置邮件通知</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-gpbackup.html#topic_xnj_b4c_tbb">理解备份文件</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-gpbackup-incremental.html">使用gpbackup和gprestore创建增量备份</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-gpbackup-incremental.html#topic_kvf_mkr_t2b">关于增量备份集</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-gpbackup-incremental.html#topic_btr_xfr_t2b">使用增量备份</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-boostfs.html">将gpbackup和gprestore与BoostFS一起使用</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-boostfs.html#topic_zp4_mvv_bdb">安装BoostFS</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-boostfs.html#topic_t4z_tvv_bdb">使用BoostFS备份和恢复</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-plugins.html">使用gpbackup存储插件</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-s3-plugin.html">使用带有gpbackup和gprestore的S3存储插件</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/backup-plugin-api.html">备份&#x2F;恢复存储插件API（Beta版）</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/plugin_api/backup_data.html">backup_data</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/plugin_api/backup_file.html">backup_file</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/plugin_api/cleanup_plugin_for_backup.html">cleanup_plugin_for_backup</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/plugin_api/cleanup_plugin_for_restore.html">cleanup_plugin_for_restore</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/plugin_api/plugin_api_version.html">plugin_api_version</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/plugin_api/restore_data.html">restore_data</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/plugin_api/restore_file.html">restore_file</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/plugin_api/setup_plugin_for_backup.html">setup_plugin_for_backup</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/plugin_api/setup_plugin_for_restore.html">setup_plugin_for_restore</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/expand/expand-main.html">扩容Greenplum系统</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/expand/expand-overview.html">系统扩容概述</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/expand/expand-planning.html">规划Greenplum系统扩容</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/expand/expand-nodes.html">准备并增加节点</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/expand/expand-initialize.html">初始化新节点</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/expand/expand-redistribute.html">重分布表</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/expand/expand-rm-schema.html">移除扩容Schema</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/monitor.html">监控Greenplum系统</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/managing/maintain.html">日常系统维护任务</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/monitoring/monitoring.html">Recommended Monitoring and Maintenance Tasks</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/partIII.html">管理Greenplum数据库访问</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/client_auth.html">配置客户端认证</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/ldap.html">使用带TLS&#x2F;SSL的LDAP认证</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/kerberos.html">使用Kerberos认证</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/kerberos-lin-client.html">为Linux客户端进行Kerberos配置</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/kerberos-win-client.html">为Windows客户端进行Kerberos配置</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/roles_privs.html">管理角色与权限</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/ddl/ddl.html">定义数据库对象</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/ddl/ddl-database.html">创建和管理数据库</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/ddl/ddl-tablespace.html">创建和管理表空间</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/ddl/ddl-schema.html">创建和管理SCHEMA</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/ddl/ddl-table.html">创建和管理表</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/ddl/ddl-storage.html">选择表存储模型</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/ddl/ddl-partition.html">对大型表分区</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/ddl/ddl-sequence.html">创建和使用序列</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/ddl/ddl-index.html">在Greenplum数据库中使用索引</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/ddl/ddl-view.html">创建和管理视图</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/distribution.html">分布与倾斜</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/dml.html">插入, 更新, 和删除数据 </a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/query.html">查询数据</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/parallel-proc.html">关于Greenplum的查询处理</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/query-piv-optimizer.html">关于GPORCA</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/query-piv-opt-overview.html">GPORCA概述</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/query-piv-opt-enable.html">启用和禁用GPORCA</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/query-piv-opt-root-partition.html">收集根分区统计信息</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/query-piv-opt-notes.html">使用GPORCA时的考虑</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/query-piv-opt-features.html">GPORCA特性和增强</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/query-piv-opt-changed.html">GPORCA改变的行为</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/query-piv-opt-limitations.html">GPORCA的限制</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/query-piv-opt-fallback.html">判断被使用的查询优化器</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/query-piv-uniform-part-tbl.html">关于统一多级分区表</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/defining-queries.html">定义查询</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/CTE-query.html">WITH查询（公用表表达式）</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/functions-operators.html">使用函数和操作符</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/json-data.html">使用JSON数据</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/xml-data.html">使用XML数据</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/textsearch/full-text-search.html">使用全文搜索</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/textsearch/intro.html">关于全文搜索</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/textsearch/tables-indexes.html">在数据库表中搜索文本</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/textsearch/controlling.html">控制文本搜索</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/textsearch/features.html">文本搜索附加功能</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/textsearch/parsers.html">文本搜索解析器</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/textsearch/dictionaries.html">文本搜索词典</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/textsearch/configuration.html">文本搜索配置示例</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/textsearch/testing.html">测试和调试文本搜索</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/textsearch/gist-gin.html">文本搜索的GiST和GIN索引</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/textsearch/psql-support.html">psql支持</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/textsearch/limitations.html">限制</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/query-performance.html">查询性能</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/spill-files.html">管理查询生成的溢出文件</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/query/topics/query-profiling.html">查询分析</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-working-with-file-based-ext-tables.html">使用外部数据</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-external-tables.html">定义外部表</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-file-protocol.html">file:&#x2F;&#x2F;协议</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-gpfdist-protocol.html">gpfdist:&#x2F;&#x2F;协议</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-gpfdists-protocol.html">gpfdists:&#x2F;&#x2F; 协议</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-pxf-protocol.html">pxf:&#x2F;&#x2F; 协议</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-s3-protocol.html">s3:&#x2F;&#x2F; 协议</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-accessing-ext-files-custom-protocol.html">使用自定义协议</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-handling-errors-ext-table-data.html">处理外部表数据中的错误</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-creating-and-using-web-external-tables.html">创建和使用外部Web表</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-creating-external-tables---examples.html">Examples for Creating External Tables</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-example-1-single-gpfdist-instance-on-single-nic-machine.html">Example 1—Single gpfdist instance on single-NIC machine</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-example-2-multiple-gpfdist-instances.html">Example 2—Multiple gpfdist instances </a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-example-3-multiple-gpfdists-instances.html">Example 3—Multiple gpfdists instances </a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-example-4-single-gpfdist-instance-with-error-logging.html">Example 4—Single gpfdist instance with error logging</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-example-5-text-format-on-a-hadoop-distributed-file-server.html">Example 5—TEXT Format on a Hadoop Distributed File Server</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-example-6-multiple-files-in-csv-format-with-header-rows.html">Example 6—Multiple files in CSV format with header rows</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-example-7-readable-web-external-table-with-script.html">Example 7—Readable External Web Table with Script</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-example-8-writable-external-table-with-gpfdist.html">Example 8—Writable External Table with gpfdist</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-example-9-writable-external-web-table-with-script.html">Example 9—Writable External Web Table with Script</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-example-10-readable-and-writable-external-tables-with-xml-transformations.html">Example 10—Readable and Writable External Tables with XML Transformations</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/pxf-overview.html">使用PXF访问外部数据</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-foreign.html">使用外部表访问外部数据</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-devel-fdw.html">写一个外部数据的包装器</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/g-using-the-greenplum-parallel-file-server--gpfdist-.html">使用Greenplum的并行文件服务器（gpfdist）</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-loading-and-unloading-data.html">装载和卸载数据</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-loading-data-using-an-external-table.html">使用外部表装载数据</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-loading-and-writing-non-hdfs-custom-data.html">装载和写入非HDFS自定义数据</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-using-a-custom-format.html">使用一种自定义格式</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-importing-and-exporting-fixed-width-data.html">导入和导出固定宽度的数据</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-examples-read-fixed-width-data.html">例子：读取宽度固定的数据</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-using-a-custom-protocol.html">使用一种自定协议</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-handling-load-errors.html">处理装载错误</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-define-an-external-table-with-single-row-error-isolation.html">定义一个带有单行错误隔离的外部表</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-create-an-error-table-and-declare-a-reject-limit.html">捕捉行格式化错误并且声明拒绝极限 </a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-viewing-bad-rows-in-the-error-table-or-error-log.html">在错误日志中查看不正确的行</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-moving-data-between-tables.html">在表之间移动数据</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-loading-data-with-gpload.html">用gpload装载数据</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/external/pxf-overview.html">使用PXF访问外部数据</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/transforming-xml-data.html">使用gpfdist和gpload转换外部数据</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-loading-data-with-copy.html">用COPY装载数据</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-running-copy-in-single-row-error-isolation-mode.html">在单行错误隔离模式中运行COPY</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-optimizing-data-load-and-query-performance.html">优化数据装载和查询性能</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-unloading-data-from-greenplum-database.html">从Greenplum数据库卸载数据</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-defining-a-file-based-writable-external-table.html">定义基于文件的可写外部表</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-example-1-greenplum-file-server-gpfdist.html">例 1—Greenplum文件服务器（gpfdist）</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-example-2-hadoop-file-server.html">例 2—Hadoop文件系统(pxf)</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-defining-a-command-based-writable-external-web-table.html">定义基于命令的可写外部Web表</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-disabling-execute-for-web-or-writable-external-tables.html">为Web或者可写外部表禁用EXECUTE</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-unloading-data-using-a-writable-external-table.html">使用可写外部表卸载数据</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-unloading-data-using-copy.html">使用COPY卸载数据</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-formatting-data-files.html">格式化数据文件</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-formatting-rows.html">格式化行</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-formatting-columns.html">格式化列</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-representing-null-values.html">表示NULL值</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-escaping.html">转义</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-escaping-in-text-formatted-files.html">在文本格式的文件中转义</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-escaping-in-csv-formatted-files.html">在CSV格式的文件中转义</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-character-encoding.html">字符编码</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-example-custom-data-access-protocol.html">自定义数据访问协议实例 </a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-installing-the-external-table-protocol.html">安装外部表协议</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/load/topics/g-gpextprotocal.c.html">gpextprotocal.c</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/partV.html">性能管理</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/perf_intro.html">管理性能</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/perf_issues.html">性能问题的常见原因</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/wlmgmt_intro.html">Greenplum数据库内存总览</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/admin_guide/wlmgmt.html">管理资源</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/workload_mgmt_resgroups.html">用资源组进行工作负载管理</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/workload_mgmt.html">使用资源队列</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/admin_guide/perf_troubleshoot.html">检修性能问题</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
  </ul>


  </div>
</div>

      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        
          <h1 class="title-container" style="display: none;">
    使用gpbackup和gprestore创建增量备份
  </h1>

          <div id="js-quick-links" >
            
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        

  <h1 class="title topictitle1">使用gpbackup和gprestore创建增量备份</h1>

  <div class="body">
    <p class="p"><samp class="ph codeph">gpbackup</samp>和<samp class="ph codeph">gprestore</samp>工具支持创建追加优化表的增量备份以及从增量备份还原。
      只有表被更改时，增量备份才会备份所有指定的堆表和追加优化的表（包括追加优化的，面向列的表）。
      例如，如果追加优化表的行已更改，则会备份该表。
      对于分区的追加优化表，仅备份更改的叶子分区。
      </p>

    <p class="p">当自上次备份以来，追加优化表更或分区表更改的数据与未更改的数据相比量很小的时候，增量备份是高效的。
      </p>

    <p class="p">仅当在上次全量备份或增量备份后对表执行以下操作之一时，增量备份才会备份追加优化表：
      </p>

    <ul class="ul" id="backup-incremental__ul_cvy_xhp_34">
      <li class="li">
        <samp class="ph codeph">ALTER TABLE</samp>
      </li>

      <li class="li">
        <samp class="ph codeph">DELETE</samp>
      </li>

      <li class="li">
        <samp class="ph codeph">INSERT</samp>
      </li>

      <li class="li">
        <samp class="ph codeph">TRUNCATE</samp>
      </li>

      <li class="li">
        <samp class="ph codeph">UPDATE</samp>
      </li>

      <li class="li">
<samp class="ph codeph">DROP</samp>然后重建表</li>

    </ul>

    <p class="p">要从增量备份还原数据，您需要一个完整的增量备份集。</p>

  </div>

  <div class="related-links">
<ul class="ullinks">
<li class="link ulchildlink">
<strong><a href="../managing/backup-gpbackup-incremental.html#topic_kvf_mkr_t2b">关于增量备份集</a></strong><br>
</li>
<li class="link ulchildlink">
<strong><a href="../managing/backup-gpbackup-incremental.html#topic_btr_xfr_t2b">使用增量备份</a></strong><br>
</li>
</ul>

<div class="familylinks">
<div class="parentlink">
<strong>Parent topic:</strong> <a class="link" href="../managing/backup-gpbackup.html">使用gpbackup和gprestore并行备份</a>
</div>
</div>
</div>
<div class="topic nested1" id="topic_kvf_mkr_t2b">
    <h2 class="title topictitle2">关于增量备份集</h2>

    <div class="body">
      <div class="p">一个增量备份集包含如下备份：<ul class="ul" id="topic_kvf_mkr_t2b__ul_gzr_nkr_t2b">
          <li class="li">一个全量的备份。这是增量备份基于的全量备份。</li>

          <li class="li">捕获全量备份后数据库的增量备份集。</li>

        </ul>
</div>

      <p class="p">例如：创建一个全量备份，然后创建三个天级增量备份。
        全量备份和全部三个增量备份就是备份集。
        关于增量备份更多信息，请参考<a class="xref" href="#topic_btr_xfr_t2b__incr_backup_scenario">使用增量备份集的例子</a>。
        </p>

      <p class="p">创建或添加到增量备份集时，<samp class="ph codeph">gpbackup</samp>可确保使用一组一致的备份选项创建集合中的备份，以确保可以在还原操作中使用备份集。
        关于备份集合一致性的信息，参考<a class="xref" href="#topic_btr_xfr_t2b">使用增量备份</a>。
        </p>

      <div class="p">创建增量备份时，包含这些选项与其他<samp class="ph codeph">gpbackup</samp>选项一起创建备份：
        <ul class="ul" id="topic_kvf_mkr_t2b__ul_lmq_rs5_p2b">
          <li class="li">
<samp class="ph codeph">--leaf-partition-data</samp> - 增量备份集中的所有备份都需要。<ul class="ul" id="topic_kvf_mkr_t2b__ul_sr1_cbv_p2b">
              <li class="li">创建全量备份时必需，该备份将作为增量备份集的基备份。</li>

              <li class="li">创建增量备份时必须。</li>

            </ul>
</li>

          <li class="li">
<samp class="ph codeph">--incremental</samp> - 创建增量备份时必须。
            <p class="p">不能将<samp class="ph codeph">--data-only</samp>或<samp class="ph codeph">--metadata-only</samp>和<samp class="ph codeph">--incremental</samp>一起使用。</p>
</li>

          <li class="li">
<samp class="ph codeph">--from-timestamp</samp> - 可选的。该选项可以和<samp class="ph codeph">--incremental</samp>一起使用。
            指定的时间戳是一个已经存在的备份。
            可以是一个全量备份或增量备份。
            创建的备份必须和使用<samp class="ph codeph">--from-timestamp</samp>选项指定的备份兼容。
            <p class="p">如果不指定<samp class="ph codeph">--from-timestamp</samp>，<samp class="ph codeph">gpbackup</samp>会尝试基于<samp class="ph codeph">gpbackup</samp>历史文件找一个兼容的备份。
              参考<a class="xref" href="#topic_btr_xfr_t2b__incr_backup_notes">增量备份说明</a>。</p>
</li>

        </ul>
</div>

    </div>

  <div class="related-links">
<div class="familylinks">
<div class="parentlink">
<strong>Parent topic:</strong> <a class="link" href="../managing/backup-gpbackup-incremental.html">使用gpbackup和gprestore创建增量备份</a>
</div>
</div>
</div>
</div>

  <div class="topic nested1" id="topic_btr_xfr_t2b">
    <h2 class="title topictitle2">使用增量备份</h2>

    <div class="body">
      <ul class="ul" id="topic_btr_xfr_t2b__ul_ors_2lr_t2b">
        <li class="li"><a class="xref" href="#topic_btr_xfr_t2b__incr_backup_scenario">使用增量备份集的例子</a></li>

        <li class="li"><a class="xref" href="#topic_btr_xfr_t2b__gpbackup_increment">使用gpbackup创建增量备份</a></li>

        <li class="li"><a class="xref" href="#topic_btr_xfr_t2b__gprestore_increment">使用gprestore从增量备份恢复</a></li>

        <li class="li"><a class="xref" href="#topic_btr_xfr_t2b__incr_backup_notes">增量备份说明</a></li>

      </ul>

      <div class="p">将增量备份添加到备份集时，<samp class="ph codeph">gpbackup</samp>通过检查以下<samp class="ph codeph">gpbackup</samp>选项来确保全量备份和增量备份是一致的：
        <ul class="ul" id="topic_btr_xfr_t2b__ul_hzr_nkr_t2b">
          <li class="li">
<samp class="ph codeph">--dbname</samp> - 数据库必须相同。</li>

          <li class="li">
<samp class="ph codeph">--backup-dir</samp> - 文件夹必须相同。备份集，全量和增量备份路径必须相同。</li>

          <li class="li">
<samp class="ph codeph">--single-data-file</samp> - 这个选项在集合中所有的备份，要么全部指定，要么全部非指定。</li>

          <li class="li">
<samp class="ph codeph">--plugin-config</samp> - 如果指定该选项，则必须在备份集中所有的备份中都指定。
            配置必须引用相同的二进制插件文件。
            </li>

          <li class="li">
            <samp class="ph codeph">--include-table-file</samp>, <samp class="ph codeph">--include-schema</samp>, 或其他过滤表和schema的选项必须相同。
            <p class="p">当检查schema筛选时，只检查schema名字，不检查schema里包含的对象。</p>
</li>

          <li class="li">
<samp class="ph codeph">--no-compression</samp> - 如果这个选项被指定，必须在备份集中所有的备份中都要指定。
            <p class="p">如果在全量备份上使用压缩，则必须在增量备份上使用压缩。
              备份集中的备份允许不同的压缩级别。
              </p>
</li>

        </ul>
</div>

      <p class="p">如果尝试将增量备份添加到备份集，则如果<samp class="ph codeph">gpbackup</samp>选项不一致，则备份操作将失败。
        </p>

      <p class="p">关于<samp class="ph codeph">gpbackup</samp>和<samp class="ph codeph">gprestore</samp>工具选项信息，
        参考<cite class="cite">Greenplum数据库工具指南</cite>中的<a class="xref" href="../../utility_guide/admin_utilities/gpbackup.html">gpbackup</a>
        和<a class="xref" href="../../utility_guide/admin_utilities/gprestore.html">gprestore</a>.</p>

      <div class="section" id="topic_btr_xfr_t2b__incr_backup_scenario">
<h3 class="title sectiontitle">使用增量备份集的例子</h3>
        
        <p class="p">每个备份都有一个创建备份时的时间戳。
          例如，如果您在2017年5月14日创建备份，则备份文件名包含<samp class="ph codeph">20170514<var class="keyword varname">hhmmss</var></samp>。
          <var class="keyword varname">hhmmss</var>表示时间：小时，分钟和秒。
          </p>

        <p class="p">此示例假定您已创建数据库<em class="ph i">mytest</em>的两个全量备份和增量备份。
          要创建全量备份，请使用以下命令：
          </p>

        <pre class="pre codeblock">gpbackup --dbname mytest --backup-dir /mybackup --leaf-partition-data</pre>

        <p class="p">使用下面命令创建增量备份：</p>

        <pre class="pre codeblock">gpbackup --dbname mytest --backup-dir /mybackup --leaf-partition-data --incremental</pre>

        <p class="p">当指定<samp class="ph codeph">--backup-dir</samp>选项时，备份被创建在每个数据库主机的<samp class="ph codeph">/mybackup</samp>目录里。</p>

        <p class="p">在该示例中，全量备份具有时间戳键<samp class="ph codeph">20170514054532</samp>和<samp class="ph codeph">20171114064330</samp>。其他备份是增量备份。
          该示例包含两个备份集，第一个具有两个增量备份，第二个具有一个增量备份。
          备份从最早到最近列出。</p>

        <div class="p" id="topic_btr_xfr_t2b__p_ryy_33p_34">
          <ul class="ul" id="topic_btr_xfr_t2b__ul_cwq_j3p_34">
            <li class="li">
<samp class="ph codeph">20170514054532</samp> (全量备份)</li>

            <li class="li">
<samp class="ph codeph">20170714095512</samp>
            </li>

            <li class="li">
<samp class="ph codeph">20170914081205</samp>
            </li>

            <li class="li">
<samp class="ph codeph">20171114064330</samp> (全量备份) </li>

            <li class="li">
<samp class="ph codeph">20180114051246</samp>
            </li>

          </ul>

        </div>

        <div class="p">要基于最新的增量备份创建新的增量备份，必须包含与增量备份相同的<samp class="ph codeph">--backup-dir</samp>选项以及<samp class="ph codeph">--leaf-partition-data</samp>和<samp class="ph codeph">--incremental</samp>选项。
          <pre class="pre codeblock">gpbackup --dbname mytest --backup-dir /mybackup --leaf-partition-data --incremental</pre>
</div>

        <p class="p">您可以指定<samp class="ph codeph">--from-timestamp</samp>选项以基于现有增量备份或全量备份创建增量备份。
          根据该示例，此命令将第四个增量备份添加到备份集，其中包括<samp class="ph codeph">20170914081205</samp>作为增量备份，并使用<samp class="ph codeph">20170514054532</samp>作为全量备份。
          </p>

        <pre class="pre codeblock">gpbackup --dbname mytest --backup-dir /mybackup --leaf-partition-data --incremental --from-timestamp 20170914081205</pre>

        <div class="p">此命令基于全量备份<samp class="ph codeph">20171114064330</samp>创建增量备份集，并与包含增量备份<samp class="ph codeph">20180114051246</samp>的备份集分开。
          <pre class="pre codeblock">gpbackup --dbname mytest --backup-dir /mybackup --leaf-partition-data --incremental --from-timestamp 20171114064330</pre>
</div>

        <div class="p">要使用增量备份<samp class="ph codeph">20170914081205</samp>还原数据库，
          需要增量备份<samp class="ph codeph">20120914081205</samp>和<samp class="ph codeph">20170714095512</samp>，
          以及全量备份<samp class="ph codeph">20170514054532</samp>。这将是<samp class="ph codeph">gprestore</samp>命令。
          <pre class="pre codeblock">gprestore --backup-dir /backupdir --timestamp 20170914081205</pre>
</div>

      </div>

      <div class="section" id="topic_btr_xfr_t2b__gpbackup_increment">
<h3 class="title sectiontitle">使用gpbackup创建增量备份</h3>
        
        <p class="p"><samp class="ph codeph">gpbackup</samp>输出显示增量备份所基于的备份的时间戳。
          在此示例中，增量备份基于时间戳为<samp class="ph codeph">20180802171642</samp>的备份。
          备份<samp class="ph codeph">20180802171642</samp>可以是增量备份或全量备份。
          </p>

        <pre class="pre codeblock">$ <strong class="ph b">gpbackup --dbname test --backup-dir /backups --leaf-partition-data --incremental</strong>
20180803:15:40:51 gpbackup:gpadmin:mdw:002907-[INFO]:-Starting backup of database test
20180803:15:40:52 gpbackup:gpadmin:mdw:002907-[INFO]:-Backup Timestamp = 20180803154051
20180803:15:40:52 gpbackup:gpadmin:mdw:002907-[INFO]:-Backup Database = test
20180803:15:40:52 gpbackup:gpadmin:mdw:002907-[INFO]:-Gathering list of tables for backup
20180803:15:40:52 gpbackup:gpadmin:mdw:002907-[INFO]:-Acquiring ACCESS SHARE locks on tables
Locks acquired:  5 / 5 [================================================================] 100.00% 0s
20180803:15:40:52 gpbackup:gpadmin:mdw:002907-[INFO]:-Gathering additional table metadata
20180803:15:40:52 gpbackup:gpadmin:mdw:002907-[INFO]:-Metadata will be written to /backups/gpseg-1/backups/20180803/20180803154051/gpbackup_20180803154051_metadata.sql
20180803:15:40:52 gpbackup:gpadmin:mdw:002907-[INFO]:-Writing global database metadata
20180803:15:40:52 gpbackup:gpadmin:mdw:002907-[INFO]:-Global database metadata backup complete
20180803:15:40:52 gpbackup:gpadmin:mdw:002907-[INFO]:-Writing pre-data metadata
20180803:15:40:52 gpbackup:gpadmin:mdw:002907-[INFO]:-Pre-data metadata backup complete
20180803:15:40:52 gpbackup:gpadmin:mdw:002907-[INFO]:-Writing post-data metadata
20180803:15:40:52 gpbackup:gpadmin:mdw:002907-[INFO]:-Post-data metadata backup complete
20180803:15:40:52 gpbackup:gpadmin:mdw:002907-[INFO]:-<strong class="ph b">Basing incremental backup off of backup with timestamp = 20180802171642</strong>
20180803:15:40:52 gpbackup:gpadmin:mdw:002907-[INFO]:-Writing data to file
Tables backed up:  4 / 4 [==============================================================] 100.00% 0s
20180803:15:40:52 gpbackup:gpadmin:mdw:002907-[INFO]:-Data backup complete
20180803:15:40:53 gpbackup:gpadmin:mdw:002907-[INFO]:-Found neither /usr/local/greenplum-db/./bin/gp_email_contacts.yaml nor /home/gpadmin/gp_email_contacts.yaml
20180803:15:40:53 gpbackup:gpadmin:mdw:002907-[INFO]:-Email containing gpbackup report /backups/gpseg-1/backups/20180803/20180803154051/gpbackup_20180803154051_report will not be sent
20180803:15:40:53 gpbackup:gpadmin:mdw:002907-[INFO]:-Backup completed successfully</pre>

      </div>

      <div class="section" id="topic_btr_xfr_t2b__gprestore_increment">
<h3 class="title sectiontitle">使用gprestore从增量备份恢复</h3>
        
        <div class="p">从增量备份还原时，可以指定<samp class="ph codeph">--verbose</samp>选项以在命令行上显示还原操作中使用的备份。
          例如，以下<samp class="ph codeph">gprestore</samp>命令使用时间戳<samp class="ph codeph">20180807092740</samp>（增量备份）还原备份。
          输出包括用于还原数据库数据的备份。
          <pre class="pre codeblock">$ <strong class="ph b">gprestore --create-db --timestamp 20180807162904 --verbose</strong>
...
20180807:16:31:56 gprestore:gpadmin:mdw:008603-[INFO]:-Pre-data metadata restore complete
20180807:16:31:56 gprestore:gpadmin:mdw:008603-[DEBUG]:-Verifying backup file count
20180807:16:31:56 gprestore:gpadmin:mdw:008603-[DEBUG]:-<strong class="ph b">Restoring data from backup with timestamp: 20180807162654</strong>
20180807:16:31:56 gprestore:gpadmin:mdw:008603-[DEBUG]:-Reading data for table public.tbl_ao from file (table 1 of 1)
20180807:16:31:56 gprestore:gpadmin:mdw:008603-[DEBUG]:-Checking whether segment agents had errors during restore
20180807:16:31:56 gprestore:gpadmin:mdw:008603-[DEBUG]:-<strong class="ph b">Restoring data from backup with timestamp: 20180807162819</strong>
20180807:16:31:56 gprestore:gpadmin:mdw:008603-[DEBUG]:-Reading data for table public.test_ao from file (table 1 of 1)
20180807:16:31:56 gprestore:gpadmin:mdw:008603-[DEBUG]:-Checking whether segment agents had errors during restore
20180807:16:31:56 gprestore:gpadmin:mdw:008603-[DEBUG]:-<strong class="ph b">Restoring data from backup with timestamp: 20180807162904</strong>
20180807:16:31:56 gprestore:gpadmin:mdw:008603-[DEBUG]:-Reading data for table public.homes2 from file (table 1 of 4)
20180807:16:31:56 gprestore:gpadmin:mdw:008603-[DEBUG]:-Reading data for table public.test2 from file (table 2 of 4)
20180807:16:31:56 gprestore:gpadmin:mdw:008603-[DEBUG]:-Reading data for table public.homes2a from file (table 3 of 4)
20180807:16:31:56 gprestore:gpadmin:mdw:008603-[DEBUG]:-Reading data for table public.test2a from file (table 4 of 4)
20180807:16:31:56 gprestore:gpadmin:mdw:008603-[DEBUG]:-Checking whether segment agents had errors during restore
20180807:16:31:57 gprestore:gpadmin:mdw:008603-[INFO]:-Data restore complete
20180807:16:31:57 gprestore:gpadmin:mdw:008603-[INFO]:-Restoring post-data metadata
20180807:16:31:57 gprestore:gpadmin:mdw:008603-[INFO]:-Post-data metadata restore complete
...</pre>
</div>

        <p class="p">输出显示还原操作使用了三个备份。</p>

        <p class="p">从增量备份还原时，<samp class="ph codeph">gprestore</samp>还会在<samp class="ph codeph">gprestore</samp>日志文件中列出还原操作中使用的备份。
          </p>

        <p class="p">在还原操作期间，如果全量备份或其他所需的增量备份不可用，<samp class="ph codeph">gprestore</samp>将显示错误。
          </p>

      </div>

      <div class="section" id="topic_btr_xfr_t2b__incr_backup_notes">
<h3 class="title sectiontitle">增量备份说明</h3>
        
        <p class="p">要创建增量备份或从增量备份集还原数据，您需要完整的备份集。
          存档增量备份时，必须存档完整的备份集。
          您必须归档在master和所有segment上创建的所有文件。
          </p>

        <p class="p">每次运行<samp class="ph codeph">gpbackup</samp>时，该工具都会将备份信息添加到Greenplum数据库master数据目录中的历史文件<samp class="ph codeph">gpbackup_history.yaml</samp>。
          该文件包括备份选项和其他备份信息。
          </p>

        <p class="p">如果在创建增量备份时未指定<samp class="ph codeph">--from-timestamp</samp>选项，则<samp class="ph codeph">gpbackup</samp>将使用具有一致选项集的最新备份。
          该工具检查备份历史记录文件以查找具有一致选项集的备份。
          如果工具找不到具有一致选项集的备份或历史文件不存在，则<samp class="ph codeph">gpbackup</samp>会显示一条消息，指出必须先创建全量备份才能创建增量。
          </p>

        <p class="p">如果在创建增量备份时指定<samp class="ph codeph">--from-timestamp</samp>选项，则<samp class="ph codeph">gpbackup</samp>可确保正在创建的备份选项与指定备份的选项一致。
          </p>

        <p class="p">对于备份集中的所有备份，<samp class="ph codeph">gpbackup</samp>选项<samp class="ph codeph">--with-stats</samp>不需要相同。
          但是，要使用<samp class="ph codeph">gprestore</samp>选项<samp class="ph codeph">--with-stats</samp>执行还原操作以还原统计信息，您指定的备份必须在创建备份时必须使用<samp class="ph codeph">--with-stats</samp>。
          </p>

        <p class="p">您可以从备份集中的任何备份执行还原操作。
          但是，将不会还原在备份用于还原数据库数据之后的增量备份中捕获的更改。
          </p>

        <p class="p">从增量备份集还原时，<samp class="ph codeph">gprestore</samp>会检查备份并从备份集中最新版本的追加优化表中还原每个追加优化表，并从最新备份还原堆表。
          </p>

        <p class="p">增量备份集，全量备份和关联的增量备份必须位于单个设备上。
          例如，备份集中的备份必须全部位于文件系统上，或者必须全部位于Data Domain系统上。
          </p>

        <div class="note warning">
<span class="warningtitle">Warning:</span> 对Greenplum数据库segment配置的更改会使增量备份无效。
          更改segment配置（添加或删除segment实例）后，必须先创建全量备份，然后才能创建增量备份。
          </div>

      </div>

    </div>

  <div class="related-links">
<div class="familylinks">
<div class="parentlink">
<strong>Parent topic:</strong> <a class="link" href="../managing/backup-gpbackup-incremental.html">使用gpbackup和gprestore创建增量备份</a>
</div>
</div>
</div>
</div>



        

      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    
  </footer>
</div><!--end of container-->

</body>
</html>
