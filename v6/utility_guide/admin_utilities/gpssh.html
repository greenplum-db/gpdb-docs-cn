<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      gpssh |
    Greenplum Database Docs
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='/images/favicon.ico' rel='shortcut icon'>

  <script src="/javascripts/all.js"></script>
  
</head>

<body class="x6-0 x6-0_utility_guide x6-0_utility_guide_admin_utilities x6-0_utility_guide_admin_utilities_gpssh has-subnav">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">
      document.domain = "greenplum.org";
    </script>

     
  <header class="header header-layout">
    <h1 class="logo">
      <a href="/">Greenplum Database Documentation</a>
    </h1>
    
    <div class="header-links js-bar-links">
      <div class="btn-menu" data-behavior="MenuMobile"></div>
      <div class="header-item"><a href="https://greenplum.org">Back to Greenplum Database</a></div>
      <div class="header-item">
        <a href="https://github.com/greenplum-db/gpdb/wiki">Wiki</a>
      </div>
      
    </div>
  </header>


    <div class="container">

      <!--googleoff: index-->
      <div id="sub-nav" class="nav-container js-sidenav" role="navigation" >
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    
  <ul>
    
      <li class="">
        <a href="/v6/utility_guide/../../v6/homenav.html">Greenplum数据库® 6.0文档</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/v6/utility_guide/utility_guide.html">工具指南</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/v6/utility_guide/admin_utilities/util_ref.html">管理工具参考</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/analyzedb.html">analyzedb</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpactivatestandby.html">gpactivatestandby</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpaddmirrors.html">gpaddmirrors</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpbackup.html">gpbackup</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpcheck.html">gpcheck</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpcheckcat.html">gpcheckcat</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpcheckperf.html">gpcheckperf</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpconfig.html">gpconfig</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpdeletesystem.html">gpdeletesystem</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpexpand.html">gpexpand</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpfdist.html">gpfdist</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpinitstandby.html">gpinitstandby</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpinitsystem.html">gpinitsystem</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpload.html">gpload</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gplogfilter.html">gplogfilter</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpmapreduce.html">gpmapreduce</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpmovemirrors.html">gpmovemirrors</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpperfmon_install.html">gpperfmon_install</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gppkg.html">gppkg</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gprecoverseg.html">gprecoverseg</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpreload.html">gpreload</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gprestore.html">gprestore</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpscp.html">gpscp</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpseginstall.html">gpseginstall</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpssh.html">gpssh</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpssh-exkeys.html">gpssh-exkeys</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpstart.html">gpstart</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpstate.html">gpstate</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpstop.html">gpstop</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/gpsys.html">gpsys1</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/pgbouncer.html">pgbouncer</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/pgbouncer-ini.html">pgbouncer.ini</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/admin_utilities/pgbouncer-admin.html">pgbouncer-admin</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/../pxf/ref/pxf.html">pxf</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/../pxf/ref/pxf-cluster.html">pxf cluster</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/utility_guide/cli_ref.html">客户端工具参考</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/v6/utility_guide/client_utilities/ClientUtilitySummary.html">客户端工具摘要</a>
        
  <ul>
    
      <li class="">
        <a href="/v6/utility_guide/client_utilities/clusterdb.html">clusterdb</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/client_utilities/createdb.html">createdb</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/client_utilities/createlang.html">createlang</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/client_utilities/createuser.html">createuser</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/client_utilities/dropdb.html">dropdb</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/client_utilities/droplang.html">droplang</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/client_utilities/dropuser.html">dropuser</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/client_utilities/pg_config.html">pg_config</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/client_utilities/pg_dump.html">pg_dump</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/client_utilities/pg_dumpall.html">pg_dumpall</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/client_utilities/pg_restore.html">pg_restore</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/client_utilities/psql.html">psql</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/client_utilities/reindexdb.html">reindexdb</a>
        

      </li>
    
      <li class="">
        <a href="/v6/utility_guide/client_utilities/vacuumdb.html">vacuumdb</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/v6/utility_guide/contrib-programs.html">附加程序</a>
        
  <ul>
    
      <li class="">
        <a href="https://www.postgresql.org/docs/9.4/pgupgrade.html">pg_upgrade</a>
        

      </li>
    
      <li class="">
        <a href="https://www.postgresql.org/docs/9.4/pgxlogdump.html">pg_xlogdump</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
  </ul>


  </div>
</div>

      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        
          <h1 class="title-container" style="display: none;">
    gpssh
  </h1>

          <div id="js-quick-links" >
            
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        

    
    <h1 class="title topictitle1">gpssh</h1>

    <div class="body">
        <p class="p">一次提供对多台主机的SSH访问。</p>

        <div class="section" id="topic1__section2">
<h2 class="title sectiontitle">概要</h2>
            
            <pre class="pre codeblock"><strong class="ph b">gpssh</strong> { <strong class="ph b">-f</strong> <var class="keyword varname">hostfile_gpssh</var> | <strong class="ph b">- h</strong> <var class="keyword varname">hostname</var> [<strong class="ph b">-h</strong> <var class="keyword varname">hostname</var> ...] } <span class="ph">[<strong class="ph b">-s</strong>] </span>[<strong class="ph b">-e</strong>]
                [<strong class="ph b">-d</strong> <var class="keyword varname">seconds</var>] [<strong class="ph b">-t</strong> <var class="keyword varname">multiplier</var>] [<strong class="ph b">-v</strong>]
                [<var class="keyword varname">bash_command</var>]
                
                <strong class="ph b">gpssh</strong> <strong class="ph b">-?</strong> 
                
                <strong class="ph b">gpssh</strong> <strong class="ph b">--version</strong></pre>

        </div>

        <div class="section" id="topic1__section3">
<h2 class="title sectiontitle">描述</h2>
            
            <p class="p"><samp class="ph codeph">gpssh</samp>工具允许用户使用SSH（安全shell）一次在多台主机上运行bash shell命令。
                用户可以通过在命令行上指定一个命令来执行单个命令，也可以省略该命令以进入交互式命令行会话。
            </p>

            <p class="p">要指定参与SSH会话的主机，请使用<samp class="ph codeph">-f</samp>选项指定包含主机名列表的文件，或使用
                <samp class="ph codeph">-h</samp>选项在命令行上指明单个主机名。至少需要一个主机名（<samp class="ph codeph">-h</samp>）
                或主机文件（<samp class="ph codeph">-f</samp>）。请注意，当前主机默认<strong class="ph b"><em class="ph i">不</em></strong>包含在会话中 — 要
                包含本地主机，用户必须在会话中涉及的主机列表中明确声明它。
            </p>

            <p class="p">在使用<samp class="ph codeph">gpssh</samp>之前，用户必须在涉及SSH会话的主机之间建立可信的主机设置。 
                用户可以使用工具<samp class="ph codeph">gpssh-exkeys</samp>更新已知的主机文件并在主机之间交换
                公钥（如果尚未这样做的话）。
            </p>

            <p class="p">如果用户没有在命令行上指定命令，<samp class="ph codeph">gpssh</samp>将进入交互模式。在<samp class="ph codeph">gpssh</samp>
                命令提示符（<samp class="ph codeph">=&gt;</samp>）处，用户可以像在常规bash终端命令行中那样输入命令，
                并且该命令将在会话涉及的所有主机上执行。要结束交互式会话，请按键盘上的<samp class="ph codeph">CTRL</samp>+<samp class="ph codeph">D</samp>
                或键入<samp class="ph codeph">exit</samp>或<samp class="ph codeph">quit</samp>。
            </p>

            <p class="p">如果主机文件中没有指定用户名，则<samp class="ph codeph">gpssh</samp>将以当前登录的用户身份执行命令。
                要确定当前登录的用户，请执行<samp class="ph codeph">whoami</samp>命令。默认情况下，登录后
                <samp class="ph codeph">gpssh</samp>将转到远程主机上的会话用户的<samp class="ph codeph">$HOME</samp>。
                为确保所有远程主机上的命令都能正确执行，应始终输入绝对路径。
            </p>

            <p class="p">如果在使用<samp class="ph codeph">gpssh</samp>时遇到网络超时问题，可以使用<samp class="ph codeph">-d</samp>和
                <samp class="ph codeph">-t</samp>选项或者在<samp class="ph codeph">gpssh.conf</samp>文件中设置参数来控制
                <samp class="ph codeph">gpssh</samp>在验证初始<samp class="ph codeph">ssh</samp>连接时使用的时间。有关配置
                文件的信息，请参阅gpssh配置文件<a class="xref" href="#topic1__section6">gpssh配置文件</a>。</p>

        </div>

        <div class="section" id="topic1__section4">
<h2 class="title sectiontitle">选项</h2>
            
            <dl class="dl parml">
                
                    <dt class="dt pt dlterm">
                        <var class="keyword varname">bash_command</var>
                    </dt>

                    <dd class="dd pd">在此会话中涉及的所有主机上执行的bash shell命令（可选择封闭在引号中）。
                        如果未指定，则<samp class="ph codeph">gpssh</samp>启动交互式会话。</dd>

                
                
                    <dt class="dt pt dlterm">-d（延迟）<var class="keyword varname">seconds</var>
</dt>

                    <dd class="dd pd">可选。指定用<samp class="ph codeph">ssh</samp>开始<samp class="ph codeph">gpssh</samp>交互开始时等待
                        的时间（以秒为单位）。默认值是<samp class="ph codeph">0.05</samp>。此选项将覆盖<samp class="ph codeph">gpssh.conf</samp>
                        配置文件中指定的<samp class="ph codeph">delaybeforesend</samp>的值。</dd>

                    <dd class="dd pd">增加此值可能会导致在<samp class="ph codeph">gpssh</samp>启动过程中等待很长时间。</dd>

                
                
                    <dt class="dt pt dlterm">-e（回显）</dt>

                    <dd class="dd pd">可选。以非交互模式运行时，回显传递给每个主机的命令及其结果输出。</dd>

                
                
                    <dt class="dt pt dlterm">-f <var class="keyword varname">hostfile_gpssh</var>
</dt>

                    <dd class="dd pd">指定包含将参与此SSH会话的主机列表的文件的名称。主机文件的语法是每行一个主机。</dd>

                
                
                    <dt class="dt pt dlterm">-h <var class="keyword varname">hostname</var>
</dt>

                    <dd class="dd pd">指定将参与此SSH会话的单个主机名。用户可以多次使用<samp class="ph codeph">-h</samp>
                        选项来指定多个主机名。</dd>

                
                
                    <dt class="dt pt dlterm">-s</dt>

                    <dd class="dd pd">可选。如果指定，则在执行目标主机上的任何命令之前，<samp class="ph codeph">gpssh</samp>将在
                        <samp class="ph codeph">$GPHOME</samp>环境变量指定的目录中引用文件<samp class="ph codeph">greenplum_path.sh</samp>。
                    </dd>

                    <dd class="dd pd">该选项对交互模式和单命令模式都有效。</dd>

                
                
                    <dt class="dt pt dlterm">-t <var class="keyword varname">multiplier</var>
                    </dt>

                    <dd class="dd pd">可选。大于0的十进制数，它是<samp class="ph codeph">gpssh</samp>在验证<samp class="ph codeph">ssh</samp>
                        提示时使用的超时的倍数。默认值为<samp class="ph codeph">1</samp>。此选项将覆盖<samp class="ph codeph">gpssh.conf</samp>
                        配置文件中的<samp class="ph codeph">prompt_validation_timeout</samp>值。
                    </dd>

                    <dd class="dd pd">增加此值对<samp class="ph codeph">gpssh</samp>启动过程影响不大。</dd>

                
                
                    <dt class="dt pt dlterm">-v（详细模式）</dt>

                    <dd class="dd pd">可选。在非交互模式下运行时，除了输出命令外，还会报告其他消息。</dd>

                
                
                    <dt class="dt pt dlterm">--version</dt>

                    <dd class="dd pd">显示此工具的版本。</dd>

                
                
                    <dt class="dt pt dlterm">-?（帮助）</dt>

                    <dd class="dd pd">显示在线帮助。</dd>

                
            </dl>

        </div>

        <div class="section" id="topic1__section6">
<h2 class="title sectiontitle">gpssh配置文件</h2>
            
            <p class="p"><samp class="ph codeph">gpssh.conf</samp>文件包含的参数可让用户调整<samp class="ph codeph">gpssh</samp>在验证初始
                <samp class="ph codeph">ssh</samp>连接时使用的时间。<samp class="ph codeph">gpssh</samp>会话使用<samp class="ph codeph">ssh</samp>
                执行命令之前，这些参数会影响网络连接。该文件的位置由环境<samp class="ph codeph">MASTER_DATA_DIRECTORY</samp>
                指定。如果未定义环境变量或<samp class="ph codeph">gpssh.conf</samp>文件不存在，<samp class="ph codeph">gpssh</samp>将
                使用默认值或使用<samp class="ph codeph">-d</samp>和<samp class="ph codeph">-t</samp>选项设置的值。有关环境变量的信息，
                请参考<cite class="cite">Greenplum数据库参考指南</cite>。
            </p>

            <p class="p"><samp class="ph codeph">gpssh.conf</samp>文件是由<samp class="ph codeph">[gpssh]</samp>部分和参数组成的文本文件。
                <samp class="ph codeph">#</samp>（井号）代表注释的开始。这是一个<samp class="ph codeph">gpssh.conf</samp>文件的例子。
            </p>

            <pre class="pre codeblock">[gpssh]
                delaybeforesend = 0.05
                prompt_validation_timeout = 1.0
                sync_retries = 5</pre>

            <p class="p">这些是<samp class="ph codeph">gpssh.conf</samp>参数。</p>

            <dl class="dl parml">
                
                    <dt class="dt pt dlterm">delaybeforesend = <var class="keyword varname">seconds</var>
</dt>

                    <dd class="dd pd">指定用<samp class="ph codeph">ssh</samp>启动<samp class="ph codeph">gpssh</samp>交互时等待的时间（以秒为单位）。
                        默认是0.05。增加此值可能会导致<samp class="ph codeph">gpssh</samp>启动过程中等待很长时间。
                        <samp class="ph codeph">-d</samp>选项覆盖此参数。</dd>

                
                
                    <dt class="dt pt dlterm">prompt_validation_timeout = <var class="keyword varname">multiplier</var>
</dt>

                    <dd class="dd pd">大于0的十进制数，它是<samp class="ph codeph">gpssh</samp>在验证<samp class="ph codeph">ssh</samp>
                        提示时使用的超时的倍数。增加这个值对<samp class="ph codeph">gpssh</samp>启动过程影响不大。
                        默认值是<samp class="ph codeph">1</samp>。<samp class="ph codeph">-t</samp>选项覆盖此参数。
                    </dd>

                
                
                    <dt class="dt pt dlterm">sync_retries = <var class="keyword varname">attempts</var>
</dt>

                    <dd class="dd pd">一个非负整数，指定<samp class="ph codeph">gpssh</samp>尝试连接远程Greenplum数据库主机的最大次数。
                        缺省值为3。如果值为0，则如果初始连接尝试失败，<samp class="ph codeph">gpssh</samp>将返回错误。
                        增加尝试次数也增加了重试次数之间的时间。此参数不能使用命令行选项进行配置。</dd>

                    <dd class="dd pd">
<samp class="ph codeph">-t</samp>选项也影响重试尝试之间的时间。
                    </dd>

                    <dd class="dd pd">增加此值可以弥补网络性能下降或部分主机性能问题，例如繁重的CPU或I/O负载。但是，
                        当无法建立连接时，增加的值也会增加错误被返回时的延迟。</dd>

                
            </dl>

        </div>

        <div class="section" id="topic1__section5">
<h2 class="title sectiontitle">示例</h2>
            
            <p class="p">与文件<samp class="ph codeph">hostfile_gpssh</samp>中列出的所有主机启动交互式SSH会话组：
            </p>

            <pre class="pre codeblock">$ gpssh -f hostfile_gpssh</pre>

            <p class="p">在<samp class="ph codeph">gpssh</samp>交互式命令提示符处，在此会话中涉及的所有主机上运行shell命令。
            </p>

            <pre class="pre codeblock">=&gt; ls -a /data/primary/*</pre>

            <p class="p">退出交互式会话：</p>

            <pre class="pre codeblock">=&gt; exit
                =&gt; quit</pre>

            <p class="p">使用名为<samp class="ph codeph">sdw1</samp>和<samp class="ph codeph">sdw2</samp>的主机启动非交互式SSH会话组，
                并将包含多个名为<samp class="ph codeph">command_file</samp>的命令的文件传递给<samp class="ph codeph">gpssh</samp>：
            </p>

            <pre class="pre codeblock">$ gpssh -h sdw1 -h sdw2 -v -e &lt; command_file</pre>

            <p class="p">在主机<samp class="ph codeph">sdw2</samp>和<samp class="ph codeph">localhost</samp>上以非交互模式执行单个命令：
            </p>

            <pre class="pre codeblock">$ gpssh -h sdw2 -h localhost -v -e 'ls -a /data/primary/*'
                $ gpssh -h sdw2 -h localhost -v -e 'echo $GPHOME'
                $ gpssh -h sdw2 -h localhost -v -e 'ls -1 | wc -l'</pre>

        </div>

        <div class="section">
<h2 class="title sectiontitle">另见</h2>
            
            <p class="p"><samp class="ph codeph"><a class="xref" href="gpssh-exkeys.html#topic1">gpssh-exkeys</a></samp>、<samp class="ph codeph"><a class="xref" href="gpscp.html#topic1">gpscp</a></samp></p>

        </div>

    </div>



        

      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    
  </footer>
</div><!--end of container-->

</body>
</html>
