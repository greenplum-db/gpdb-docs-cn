<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      pg_restore |
    Greenplum Database Docs
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/gpdb-docs-cn/stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="/gpdb-docs-cn/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='/gpdb-docs-cn/images/favicon.ico' rel='shortcut icon'>

  <script src="/gpdb-docs-cn/javascripts/all.js"></script>
  
</head>

<body class="x6-0 x6-0_utility_guide x6-0_utility_guide_client_utilities x6-0_utility_guide_client_utilities_pg_restore has-subnav">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">
      document.domain = "greenplum.org";
    </script>

     
  <header class="header header-layout">
    <h1 class="logo">
      <a href="/">Greenplum Database Documentation</a>
    </h1>
    
    <div class="header-links js-bar-links">
      <div class="btn-menu" data-behavior="MenuMobile"></div>
      <div class="header-item"><a href="https://greenplum.org">Back to Greenplum Database</a></div>
      <div class="header-item">
        <a href="https://github.com/greenplum-db/gpdb/wiki">Wiki</a>
      </div>
      
    </div>
  </header>


    <div class="container">

      <!--googleoff: index-->
      <div id="sub-nav" class="nav-container js-sidenav" role="navigation" >
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/../../gpdb-docs-cn/v6/homenav.html">Greenplum数据库® 6.0文档</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/utility_guide/utility_guide.html">工具指南</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/util_ref.html">管理工具参考</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/analyzedb.html">analyzedb</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpactivatestandby.html">gpactivatestandby</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpaddmirrors.html">gpaddmirrors</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpbackup.html">gpbackup</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpcheck.html">gpcheck</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpcheckcat.html">gpcheckcat</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpcheckperf.html">gpcheckperf</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpconfig.html">gpconfig</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpdeletesystem.html">gpdeletesystem</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpexpand.html">gpexpand</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpfdist.html">gpfdist</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpinitstandby.html">gpinitstandby</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpinitsystem.html">gpinitsystem</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpload.html">gpload</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gplogfilter.html">gplogfilter</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpmapreduce.html">gpmapreduce</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpmovemirrors.html">gpmovemirrors</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpperfmon_install.html">gpperfmon_install</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gppkg.html">gppkg</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gprecoverseg.html">gprecoverseg</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpreload.html">gpreload</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gprestore.html">gprestore</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpscp.html">gpscp</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpseginstall.html">gpseginstall</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpssh.html">gpssh</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpssh-exkeys.html">gpssh-exkeys</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpstart.html">gpstart</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpstate.html">gpstate</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpstop.html">gpstop</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/gpsys.html">gpsys1</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/pgbouncer.html">pgbouncer</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/pgbouncer-ini.html">pgbouncer.ini</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/admin_utilities/pgbouncer-admin.html">pgbouncer-admin</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/../pxf/ref/pxf.html">pxf</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/../pxf/ref/pxf-cluster.html">pxf cluster</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/utility_guide/cli_ref.html">客户端工具参考</a>
        
  <ul>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/utility_guide/client_utilities/ClientUtilitySummary.html">客户端工具摘要</a>
        
  <ul>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/client_utilities/clusterdb.html">clusterdb</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/client_utilities/createdb.html">createdb</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/client_utilities/createlang.html">createlang</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/client_utilities/createuser.html">createuser</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/client_utilities/dropdb.html">dropdb</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/client_utilities/droplang.html">droplang</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/client_utilities/dropuser.html">dropuser</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/client_utilities/pg_config.html">pg_config</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/client_utilities/pg_dump.html">pg_dump</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/client_utilities/pg_dumpall.html">pg_dumpall</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/client_utilities/pg_restore.html">pg_restore</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/client_utilities/psql.html">psql</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/client_utilities/reindexdb.html">reindexdb</a>
        

      </li>
    
      <li class="">
        <a href="/gpdb-docs-cn/v6/utility_guide/client_utilities/vacuumdb.html">vacuumdb</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="/gpdb-docs-cn/v6/utility_guide/contrib-programs.html">附加程序</a>
        
  <ul>
    
      <li class="">
        <a href="https://www.postgresql.org/docs/9.4/pgupgrade.html">pg_upgrade</a>
        

      </li>
    
      <li class="">
        <a href="https://www.postgresql.org/docs/9.4/pgxlogdump.html">pg_xlogdump</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
  </ul>


  </div>
</div>

      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        
          <h1 class="title-container" style="display: none;">
    pg_restore
  </h1>

          <div id="js-quick-links" >
            
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        

  <h1 class="title topictitle1">pg_restore</h1>

  <div class="body">
    <p class="p" id="topic1__client_util_desc">从<samp class="ph codeph">pg_dump</samp>创建的存档文件中恢复数据库。
      </p>

    <div class="section" id="topic1__section2">
<h2 class="title sectiontitle">概要</h2>
      
      <pre class="pre codeblock" id="topic1__client_util_synopsis"><strong class="ph b">pg_restore</strong> [<var class="keyword varname">connection-option</var> ...] [<var class="keyword varname">restore_option</var> ...] <var class="keyword varname">filename</var>

<strong class="ph b">pg_restore</strong> <strong class="ph b">-? | --help</strong>

<strong class="ph b">pg_restore</strong> <strong class="ph b">-V | --version</strong></pre>

    </div>

    <div class="section" id="topic1__section3">
<h2 class="title sectiontitle">描述</h2>
      
      <p class="p"><samp class="ph codeph">pg_restore</samp>是一种工具，用于从<samp class="ph codeph"><a class="xref" href="pg_dump.html#topic1">pg_dump</a></samp>创建的非明文格式之一的存档中恢复数据库。
        它将发出将数据库重建到保存时所处状态的必要命令。
        存档文件还允许<samp class="ph codeph">pg_restore</samp>对恢复的内容具有选择性，甚至可以在恢复之前对项目进行重新排序。
        </p>

      <p class="p"><samp class="ph codeph">pg_restore</samp>可以在两种模式下运行。
        如果指定了数据库名称，则存档将直接还原到数据库中。
        否则，将创建一个脚本，该脚本包含重建数据库所需的SQL命令，并将其写入文件或标准输出。
        脚本输出等效于<samp class="ph codeph">pg_dump</samp>的纯文本输出格式。
        因此，控制输出的某些选项类似于<samp class="ph codeph">pg_dump</samp>选项。
        </p>

      <p class="p"><samp class="ph codeph">pg_restore</samp>无法恢复存档文件中不存在的信息。
        例如，如果使用“将数据作为<samp class="ph codeph">INSERT</samp>命令转储”选项进行归档，则<samp class="ph codeph">pg_restore</samp>将无法使用<samp class="ph codeph">COPY</samp>语句加载数据。
        </p>

      <div class="note note">
<span class="notetitle">Note:</span> <samp class="ph codeph">--ignore-version</samp>选项已弃用，在以后的版本中将被删除。
        </div>

    </div>

    <div class="section" id="topic1__section4">
<h2 class="title sectiontitle">选项</h2>
      
      <dl class="dl parml">
        
          <dt class="dt pt dlterm">
            <var class="keyword varname">filename</var>
          </dt>

          <dd class="dd pd">指定要还原的档案文件的位置（或目录，对于目录格式归档）。
            如果未指定，则使用标准输入。
            </dd>

        
      </dl>

      <div class="sectiondiv">
        <strong class="ph b">恢复选项</strong>
        <dl class="dl parml">
          
            <dt class="dt pt dlterm">-a | --data-only</dt>

            <dd class="dd pd">仅转储数据，而不转储模式（数据定义）。表数据和序列值将转储，如果在归档文件中有的话。
              <p class="p">此选项与<samp class="ph codeph">--section=data</samp>相似，但由于历史原因不同。
                </p>
</dd>

          
          
            <dt class="dt pt dlterm">-c | --clean</dt>

            <dd class="dd pd">在重新创建数据库对象之前，先对其进行清理（删除）。
              （如果目标数据库中不存在任何对象，则恢复可能会生成一些无害的错误消息。）
              </dd>

          
          
            <dt class="dt pt dlterm">-C | --create</dt>

            <dd class="dd pd">在还原到数据库之前先创建它。
              如果还指定了<samp class="ph codeph">--clean</samp>，请在连接到目标数据库之前删除并重新创建目标数据库。
              </dd>

            <dd class="dd pd">使用此选项时，以<samp class="ph codeph">-d</samp>命名的数据库仅用于发出初始<samp class="ph codeph">DROP DATABASE</samp>和<samp class="ph codeph">CREATE DATABASE</samp>命令。
              所有数据都将还原到存档中显示的数据库名称中。
              </dd>

          
          
            <dt class="dt pt dlterm">-d <var class="keyword varname">dbname</var> | --dbname=<var class="keyword varname">dbname</var>
</dt>

            <dd class="dd pd">连接到该数据库，然后直接还原到该数据库。
              与大多数其他Greenplum数据库工具一样，该工具也使用<samp class="ph codeph">libpq</samp>支持的环境变量。
              但是，如果未提供数据库名称，它将不会读取<samp class="ph codeph">PGDATABASE</samp>。
              </dd>

          
          
            <dt class="dt pt dlterm">-e | --exit-on-error</dt>

            <dd class="dd pd">如果在向数据库发送SQL命令时遇到错误，则退出。
              默认设置为继续并在还原结束时显示错误计数。
              </dd>

          
          
            <dt class="dt pt dlterm">-f <var class="keyword varname">outfilename</var> | --file=<var class="keyword varname">outfilename</var>
</dt>

            <dd class="dd pd">为生成的脚本或与<samp class="ph codeph">-l</samp>一起使用的列表指定输出文件。默认为标准输出。
              </dd>

          
          
            <dt class="dt pt dlterm">-F c|d|t | --format={custom | directory | tar}</dt>

            <dd class="dd pd">
<samp class="ph codeph"><a class="xref" href="pg_dump.html#topic1">pg_dump</a></samp>生成的归档文件格式。
              无需指定格式，因为<samp class="ph codeph">pg_restore</samp>将自动确定格式。
              格式可以是<samp class="ph codeph">custom</samp>，<samp class="ph codeph">directory</samp>或<samp class="ph codeph">tar</samp>。
              </dd>

          
          
            <dt class="dt pt dlterm">-i | --ignore-version</dt>

            <dd class="dd pd">
<div class="note note">
<span class="notetitle">Note:</span> 此选项已被弃用，并将在以后的版本中删除。</div>

              忽略数据库版本检查。</dd>

          
          
            <dt class="dt pt dlterm">-I <var class="keyword varname">index</var> | --index=<var class="keyword varname">index</var>
</dt>

            <dd class="dd pd">仅还原命名索引的定义。</dd>

          
          
            <dt class="dt pt dlterm">-j | --number-of-jobs | --jobs=<var class="keyword varname">number-of-jobs</var>
</dt>

            <dd class="dd pd">使用多个并发作业运行<samp class="ph codeph">pg_restore</samp>中最耗时的部分 - 加载数据，创建索引或创建约束的部分。
              此选项可以大大减少将大型数据库还原到多处理器计算机上运行的服务器的时间。
              </dd>

            <dd class="dd pd">每个作业是一个进程或一个线程，具体取决于操作系统，并使用与服务器的单独连接。
              </dd>

            <dd class="dd pd">此选项的最佳值取决于服务器，客户端和网络的硬件设置。
              影响因素包括CPU内核数和磁盘设置。
              一个不错的起点是服务器上的CPU内核数量，但是在许多情况下，大于该数量的值也可以缩短还原时间。
              当然，太高的值会由于抖动而导致性能下降。
              </dd>

            <dd class="dd pd">此选项仅支持自定义存档格式。
              输入文件必须是常规文件（例如，不是管道）。
              发出脚本而不是直接连接到数据库服务器时，将忽略此选项。
              另外，不能将多个作业与<samp class="ph codeph">--single-transaction</samp>选项一起使用。
              </dd>

          
          
            <dt class="dt pt dlterm">-l | --list</dt>

            <dd class="dd pd">列出归档的内容。
              此操作的输出可与<samp class="ph codeph">-L</samp>选项一起使用，以限制和重新排序要还原的项目。
              </dd>

          
          
            <dt class="dt pt dlterm">-L <var class="keyword varname">list-file</var> | --use-list=<var class="keyword varname">list-file</var>
</dt>

            <dd class="dd pd">仅还原<var class="keyword varname">list-file</var>中的元素，并还原它们在文件中出现的顺序。
              请注意，如果将<samp class="ph codeph">-n</samp>或<samp class="ph codeph">-t</samp>之类的过滤开关与<samp class="ph codeph">-L</samp>一起使用，它们将进一步限制恢复的项目。
              <p class="p">通常，通过编辑先前的<samp class="ph codeph">-l</samp>操作的输出来创建<var class="keyword varname">list-file</var>。
                可以移动或删除行，也可以通过在行的开头放置分号（;）来注释掉行。
                请参阅下面的示例。
                </p>
</dd>

          
          
            <dt class="dt pt dlterm">-n <var class="keyword varname">schema</var> | --schema=<var class="keyword varname">schema</var>
</dt>

            <dd class="dd pd">仅还原命名模式中的对象。
              可以将其与<samp class="ph codeph">-t</samp>选项结合使用以仅还原特定表。
              </dd>

          
          
            <dt class="dt pt dlterm">-O | --no-owner</dt>

            <dd class="dd pd">不要输出命令来设置对象的所有权以匹配原始数据库。
              默认情况下，<samp class="ph codeph">pg_restore</samp>发出<samp class="ph codeph">ALTER OWNER</samp>或<samp class="ph codeph">SET SESSION AUTHORIZATION</samp>语句来设置所创建模式元素的所有权。
              除非由超级用户（或拥有脚本中所有对象的同一用户）建立与数据库的初始连接，否则这些语句将失败。
              使用<samp class="ph codeph">-O</samp>，可以将任何用户名用于初始连接，并且该用户将拥有所有创建的对象。
              </dd>

          
          
            <dt class="dt pt dlterm">-P '<var class="keyword varname">function-name</var>(<var class="keyword varname">argtype</var> [, ...])' |
                --function='<var class="keyword varname">function-name</var>(<var class="keyword varname">argtype</var> [,
              ...])'</dt>

            <dd class="dd pd">仅还原命名函数。
              函数名称必须用引号引起来。
              注意，函数名称和参数的拼写必须与转储文件的目录中的拼写完全相同（如<samp class="ph codeph">--list</samp>选项所示）。
              </dd>

          
          
            <dt class="dt pt dlterm">-s | --schema-only</dt>

            <dd class="dd pd">如果模式条目存在于归档中，则仅还原模式（数据定义），而不还原数据。
              <p class="p">此选项与<samp class="ph codeph">--data-only</samp>相反。
                它类似于<samp class="ph codeph">--section=pre-data --section=post-data</samp>，但由于历史原因不同。
                </p>

              <p class="p">（不要将此与<samp class="ph codeph">--schema</samp>选项混淆，该选项以不同的含义使用“schema”一词。）
                </p>
</dd>

          
          
            <dt class="dt pt dlterm">-S <var class="keyword varname">username</var> | --superuser=<var class="keyword varname">username</var>
</dt>

            <dd class="dd pd">指定禁用触发器时要使用的超级用户名。
              仅在使用<samp class="ph codeph">--disable-triggers</samp>时才有意义。
              <div class="note note">
<span class="notetitle">Note:</span> Greenplum数据库不支持用户定义的触发器。</div>
</dd>

          
          
            <dt class="dt pt dlterm">-t <var class="keyword varname">table</var> | --table=<var class="keyword varname">table</var>
</dt>

            <dd class="dd pd">仅还原命名表的定义和/或数据。
              可以使用多个<samp class="ph codeph">-t</samp>开关指定多个表。
              可以将它与<samp class="ph codeph">-n</samp>选项结合使用以指定模式。
              </dd>

          
          
            <dt class="dt pt dlterm">-T <var class="keyword varname">trigger</var> | --trigger=<var class="keyword varname">trigger</var>
</dt>

            <dd class="dd pd">仅还原命名触发器。
              <div class="note note">
<span class="notetitle">Note:</span> Greenplum数据库不支持用户定义的触发器。</div>
</dd>

          
          
            <dt class="dt pt dlterm">-v | --verbose</dt>

            <dd class="dd pd">指定详细模式。</dd>

          
          
            <dt class="dt pt dlterm">-V | --version</dt>

            <dd class="dd pd">打印<samp class="ph codeph">pg_restore</samp>版本并退出。</dd>

          
          
            <dt class="dt pt dlterm">-x | --no-privileges | --no-acl</dt>

            <dd class="dd pd">防止转储访问权限（<samp class="ph codeph">GRANT/REVOKE</samp>命令）。
              </dd>

          
          
            <dt class="dt pt dlterm">-1 | --single-transaction</dt>

            <dd class="dd pd">作为单个事务执行还原。
              这样可以确保所有命令都成功完成，或者不应用任何更改。
              </dd>

          
          
            <dt class="dt pt dlterm">--disable-triggers</dt>

            <dd class="dd pd">仅当创建仅数据恢复时，此选项才相关。
              它指示<samp class="ph codeph">pg_restore</samp>在重载数据时执行命令以临时禁用目标表上的触发器。
              如果不想在数据重装期间调用的表上有触发器，请使用此选项。
              为<samp class="ph codeph">--disable-triggers</samp>发出的命令必须以超级用户身份执行。
              因此，您还应该使用<samp class="ph codeph">-S</samp>指定超级用户名，或者最好以超级用户身份运行<samp class="ph codeph">pg_restore</samp>。
              <div class="note note">
<span class="notetitle">Note:</span> Greenplum数据库不支持用户定义的触发器。</div>
</dd>

          
          
            <dt class="dt pt dlterm">--no-data-for-failed-tables</dt>

            <dd class="dd pd">默认情况下，即使表的创建命令失败（例如，因为它已经存在），表数据也将还原。
              使用此选项，将跳过此类表的数据。
              当目标数据库可能已经包含所需的表内容时，此行为很有用。
              指定此选项可防止加载重复或过时的数据。
              该选项仅在直接还原到数据库中时才有效，在生成 SQL 脚本输出时无效。
              </dd>

          
          
            <dt class="dt pt dlterm">--no-security-labels</dt>

            <dd class="dd pd">即使存档包含安全标签，也不要输出命令以还原安全标签。
              </dd>

          
          
            <dt class="dt pt dlterm">--no-tablespaces</dt>

            <dd class="dd pd">不输出命令以选择表空间。
              使用此选项，将在还原期间的默认表空间中创建所有对象。
              </dd>

          
          
            <dt class="dt pt dlterm">--section=<var class="keyword varname">sectionname</var>
</dt>

            <dd class="dd pd">仅还原命名节。
              节名称可以是<samp class="ph codeph">pre-data</samp>，<samp class="ph codeph">data</samp>或<samp class="ph codeph">post-data</samp>。
              可以多次指定此选项以选择多个节。
              </dd>

            <dd class="dd pd">默认为还原所有节。</dd>

          
          
            <dt class="dt pt dlterm">--use-set-session-authorization</dt>

            <dd class="dd pd">输出SQL标准的<samp class="ph codeph">SET SESSION AUTHORIZATION</samp>命令而不是<samp class="ph codeph">ALTER OWNER</samp>命令来确定对象所有权。
              这使转储更加符合标准，但是依赖转储中对象的历史记录，可能无法正确还原。
              </dd>

          
          
            <dt class="dt pt dlterm">-? | --help</dt>

            <dd class="dd pd">显示有关<samp class="ph codeph">pg_restore</samp>命令行参数的帮助，然后退出。</dd>

          
        </dl>

      </div>
      <div class="sectiondiv">
        <strong class="ph b">连接选项</strong>
        <dl class="dl parml">
          
            <dt class="dt pt dlterm">-h <var class="keyword varname">host</var> | --host <var class="keyword varname">host</var>
</dt>

            <dd class="dd pd">运行Greenplum数据库master数据库服务器的计算机的主机名。
              如果未指定，则从环境变量<samp class="ph codeph">PGHOST</samp>读取或默认为localhost。
              </dd>

          
          
            <dt class="dt pt dlterm">-p <var class="keyword varname">port</var> | --port <var class="keyword varname">port</var>
</dt>

            <dd class="dd pd">Greenplum master数据库服务器正在侦听连接的TCP端口。
              如果未指定，则从环境变量<samp class="ph codeph">PGPORT</samp>读取或默认为5432。
              </dd>

          
          
            <dt class="dt pt dlterm">-U <var class="keyword varname">username</var> | --username <var class="keyword varname">username</var>
</dt>

            <dd class="dd pd">要用作连接的数据库角色名称。
              如果未指定，则从环境变量<samp class="ph codeph">PGUSER</samp>读取或默认为当前系统角色名称。
              </dd>

          
          
            <dt class="dt pt dlterm">-w | --no-password</dt>

            <dd class="dd pd">不发出密码提示。
              如果服务器要求密码验证，而其他方式（例如<samp class="ph codeph">.pgpass</samp>文件）无法使用密码，则连接尝试将失败。
              此选项在没有用户输入密码的批处理作业和脚本中很有用。</dd>

          
          
            <dt class="dt pt dlterm">-W | --password</dt>

            <dd class="dd pd">强制输入密码提示。</dd>

          
          
            <dt class="dt pt dlterm">--role=<var class="keyword varname">rolename</var>
</dt>

            <dd class="dd pd">指定用于执行还原的角色名称。
              此选项使<samp class="ph codeph">pg_restore</samp>在连接到数据库后发出<samp class="ph codeph">SET ROLE <var class="keyword varname">rolename</var></samp>命令。
              当通过身份验证的用户（由<samp class="ph codeph">-U</samp>指定）缺少<samp class="ph codeph">pg_restore</samp>所需的特权，但可以切换到具有所需权限的角色时，此功能很有用。
              某些安装有禁止直接以超级用户身份登录的策略，并且使用此选项可以在不违反策略的情况下进行还原。
              </dd>

          
        </dl>

      </div>
    </div>

    <div class="section" id="topic1__section6">
<h2 class="title sectiontitle">注解</h2>
      
      <p class="p">如果您的安装对<samp class="ph codeph">template1</samp>数据库有任何本地添加，请小心将<samp class="ph codeph">pg_restore</samp>的输出加载到一个真正的空数据库中；
        否则，由于添加对象的重复定义，您很可能会出错。
        要创建没有任何本地添加的空数据库，请从<samp class="ph codeph">template0</samp>而不是<samp class="ph codeph">template1</samp>复制，例如：
        </p>

      <pre class="pre codeblock">CREATE DATABASE foo WITH TEMPLATE template0;</pre>

      <p class="p">当将数据恢复到预先存在的表并使用选项<samp class="ph codeph">--disable-triggers</samp>时，
        <samp class="ph codeph">pg_restore</samp>在插入数据之前发出命令以禁用用户表上的触发器，然后在插入数据后发出命令以重新启用它们。
        如果还原在中间停止，则系统catalog可能处于错误状态。
        </p>

      <p class="p">另请参阅<samp class="ph codeph">pg_dump</samp>文档以获取有关<samp class="ph codeph">pg_dump</samp>限制的详细信息。
        </p>

      <p class="p">还原后，明智的做法是在每个还原的表上运行<samp class="ph codeph">ANALYZE</samp>，以便查询优化器具有有用的统计信息。
        </p>

    </div>

    <div class="section" id="topic1__section7">
<h2 class="title sectiontitle">示例</h2>
      
      <p class="p">假设我们已经将名为<samp class="ph codeph">mydb</samp>的数据库转储到了自定义格式的转储文件中：
        </p>

      <pre class="pre codeblock">pg_dump -Fc mydb &gt; db.dump</pre>

      <p class="p">删除数据库并从转储中重新创建它：</p>

      <pre class="pre codeblock">dropdb mydb
pg_restore -C -d template1 db.dump</pre>

      <p class="p">要将转储重新加载到名为<samp class="ph codeph">newdb</samp>的新数据库中。
        请注意，这里没有<samp class="ph codeph">-C</samp>，而是直接连接到要还原到的数据库。
        还要注意，我们从<samp class="ph codeph">template0</samp>而不是<samp class="ph codeph">template1</samp>克隆新数据库，以确保它最初是空的：
        </p>

      <pre class="pre codeblock">createdb -T template0 newdb
pg_restore -d newdb db.dump</pre>

      <p class="p">要重新排序数据库项，首先必须转储归档的目录：
        </p>

      <pre class="pre codeblock">pg_restore -l db.dump &gt; db.list</pre>

      <p class="p">清单文件由一个标题和每个项目的一行组成，例如，</p>

      <pre class="pre codeblock">; Archive created at Mon Sep 14 13:55:39 2009
;     dbname: DBDEMOS
;     TOC Entries: 81
;     Compression: 9
;     Dump Version: 1.10-0
;     Format: CUSTOM
;     Integer: 4 bytes
;     Offset: 8 bytes
;     Dumped from database version: 8.3.5
;     Dumped by pg_dump version: 8.3.8
;
; Selected TOC Entries:
;
3; 2615 2200 SCHEMA - public pasha
1861; 0 0 COMMENT - SCHEMA public pasha
1862; 0 0 ACL - public pasha
317; 1247 17715 TYPE public composite pasha
319; 1247 25899 DOMAIN public domain0 pasha2</pre>

      <p class="p">分号开始注释，行开头的数字指代分配给每个项目的内部档案ID。
        文件中的行可以被注释掉，删除和重新排序。
        例如：
        </p>

      <pre class="pre codeblock">10; 145433 TABLE map_resolutions postgres
;2; 145344 TABLE species postgres
;4; 145359 TABLE nt_header postgres
6; 145402 TABLE species_records postgres
;8; 145416 TABLE ss_old postgres</pre>

      <p class="p">可以用作<samp class="ph codeph">pg_restore</samp>的输入，并且只能按以下顺序恢复项目10和6：
        </p>

      <pre class="pre codeblock">pg_restore -L db.list db.dump</pre>

    </div>

    <div class="section" id="topic1__section8">
<h2 class="title sectiontitle">另见</h2>
      
      <p class="p">
        <samp class="ph codeph">
          <a class="xref" href="pg_dump.html#topic1">pg_dump</a>
        </samp>
      </p>

    </div>

  </div>



        

      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    
  </footer>
</div><!--end of container-->

</body>
</html>
